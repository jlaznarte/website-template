/*!
 * The MIT License
 *
 * Copyright (c) 2012 James Allardice
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 */

WILEY.require(["common/modules/jquery-loader","primNav","customSelect","searchForm"],function(e,t,n,r){"use strict";t.init(e(".prim-nav")),n.init(e(".custom-select__select")),r.init(e(".search__input-wrap"))}),WILEY.define("sites/esa/shared/scripts/loader",[],function(){}),WILEY.define("placeholder",["jquery"],function(e){(function(e){"use strict";function _(){}function D(){try{return document.activeElement}catch(e){}}function P(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return!0;return!1}function H(e,t,n){if(e.addEventListener)return e.addEventListener(t,n,!1);if(e.attachEvent)return e.attachEvent("on"+t,n)}function B(e,t){var n;e.createTextRange?(n=e.createTextRange(),n.move("character",t),n.select()):e.selectionStart&&(e.focus(),e.setSelectionRange(t,t))}function j(e,t){try{return e.type=t,!0}catch(n){return!1}}function F(e,t){if(e&&e.getAttribute(a))t(e);else{var n=e?e.getElementsByTagName("input"):E,r=e?e.getElementsByTagName("textarea"):S,i=n?n.length:0,s=r?r.length:0,o=i+s,u;for(var f=0;f<o;f++)u=f<i?n[f]:r[f-i],t(u)}}function I(e){F(e,R)}function q(e){F(e,U)}function R(e,t){var n=!!t&&e.value!==t,r=e.value===e.getAttribute(a);if((n||r)&&e.getAttribute(f)==="true"){e.removeAttribute(f),e.value=e.value.replace(e.getAttribute(a),""),e.className=e.className.replace(u,"");var i=e.getAttribute(v);parseInt(i,10)>=0&&(e.setAttribute("maxLength",i),e.removeAttribute(v));var s=e.getAttribute(l);return s&&(e.type=s),!0}return!1}function U(e){var t=e.getAttribute(a);if(e.value===""&&t){e.setAttribute(f,"true"),e.value=t,e.className+=" "+o;var n=e.getAttribute(v);n||(e.setAttribute(v,e.maxLength),e.removeAttribute("maxLength"));var r=e.getAttribute(l);return r?e.type="text":e.type==="password"&&j(e,"text")&&e.setAttribute(l,"password"),!0}return!1}function z(e){return function(){x&&e.value===e.getAttribute(a)&&e.getAttribute(f)==="true"?B(e,0):R(e)}}function W(e){return function(){U(e)}}function X(e){return function(){I(e)}}function V(e){return function(t){w=e.value;if(e.getAttribute(f)==="true"&&w===e.getAttribute(a)&&P(i,t.keyCode))return t.preventDefault&&t.preventDefault(),!1}}function $(e){return function(){R(e,w),e.value===""&&(e.blur(),B(e,0))}}function J(e){return function(){e===D()&&e.value===e.getAttribute(a)&&e.getAttribute(f)==="true"&&B(e,0)}}function K(e){var t=e.form;t&&typeof t=="string"&&(t=document.getElementById(t),t.getAttribute(c)||(H(t,"submit",X(t)),t.setAttribute(c,"true"))),H(e,"focus",z(e)),H(e,"blur",W(e)),x&&(H(e,"keydown",V(e)),H(e,"keyup",$(e)),H(e,"click",J(e))),e.setAttribute(h,"true"),e.setAttribute(a,k),(x||e!==D())&&U(e)}var t=document.createElement("input"),n=t.placeholder!==void 0;e.Placeholders={nativeSupport:n,disable:n?_:I,enable:n?_:q};if(n)return;var r=["text","search","url","tel","email","password","number","textarea"],i=[27,33,34,35,36,37,38,39,40,8,46],s="#ccc",o="placeholdersjs",u=new RegExp("(?:^|\\s)"+o+"(?!\\S)"),a="data-placeholder-value",f="data-placeholder-active",l="data-placeholder-type",c="data-placeholder-submit",h="data-placeholder-bound",p="data-placeholder-focus",d="data-placeholder-live",v="data-placeholder-maxlength",m=100,g=document.getElementsByTagName("head")[0],y=document.documentElement,b=e.Placeholders,w,E=document.getElementsByTagName("input"),S=document.getElementsByTagName("textarea"),x=y.getAttribute(p)==="false",T=y.getAttribute(d)!=="false",N=document.createElement("style");N.type="text/css";var C=document.createTextNode("."+o+" {"+"color:"+s+";"+"}");N.styleSheet?N.styleSheet.cssText=C.nodeValue:N.appendChild(C),g.insertBefore(N,g.firstChild);var k,L;for(var A=0,O=E.length+S.length;A<O;A++)L=A<E.length?E[A]:S[A-E.length],k=L.attributes.placeholder,k&&(k=k.nodeValue,k&&P(r,L.type)&&K(L));var M=setInterval(function(){for(var e=0,t=E.length+S.length;e<t;e++){L=e<E.length?E[e]:S[e-E.length],k=L.attributes.placeholder;if(k){k=k.nodeValue;if(k&&P(r,L.type)){L.getAttribute(h)||K(L);if(k!==L.getAttribute(a)||L.type==="password"&&!L.getAttribute(l))L.type==="password"&&!L.getAttribute(l)&&j(L,"text")&&L.setAttribute(l,"password"),L.value===L.getAttribute(a)&&(L.value=k),L.setAttribute(a,k)}}else L.getAttribute(f)&&(R(L),L.removeAttribute(a))}T||clearInterval(M)},m);H(e,"beforeunload",function(){b.disable()})})(this),function(e,t){"use strict";var n=e.fn.val,r=e.fn.prop;t.Placeholders.nativeSupport||(e.fn.val=function(e){var t=n.apply(this,arguments),r=this.eq(0).data("placeholder-value");return e===undefined&&this.eq(0).data("placeholder-active")&&t===r?"":t},e.fn.prop=function(e,t){return t===undefined&&this.eq(0).data("placeholder-active")&&e==="value"?"":r.apply(this,arguments)})}(e,this)}),WILEY.define("state",["jquery"],function(e){WILEY.states={medium:{media:"screen and (max-width: 768px) and (min-width: 0px)",matched:"wiley:medium",unmatched:"wiley:medium-unmatched"}},function(t){"use strict";var n=t.matchMedia,r=e(t),i=function(e){this.states=e,this.initialise()};i.prototype={initialise:function(){n&&n("all").addListener&&this.setEvents()},setEvents:function(){var t=this;e.each(this.states,function(e,r){var i=n(r.media);i.addListener(function(e){t.setState(e,r)}),i.matches&&t.setState(i,r)})},setState:function(e,t){e.matches?setTimeout(function(){r.triggerHandler(t.matched)},0):r.triggerHandler(t.unmatched)}},new i(WILEY.states)}(window)}),WILEY.define("customSelect",["jquery"],function(e){var t={constructor:function(t){this.element=e(t),this.setEvents()},setEvents:function(){var e=this;this.element.on("change.wiley:custom-select",function(){e.setSelected(this)})},setSelected:function(t){e(t).prevAll(".js-custom-select__selected-text").text(t.options[t.selectedIndex].text)}};return{init:function(e){t.constructor(e)}}}),WILEY.define("searchForm",["jquery","state","placeholder"],function(e,t,n){var r={constructor:function(t){this.element=e(t),this.setElements(),this.setData(),this.setEvents(),this.setSearchButton(this.searchText.val().length)},setElements:function(){this.searchText=e(".js-search__input-text",this.element),this.searchButton=e(".js__search-submit",this.element),this.clearButton=e(".js__button-remove",this.element)},setData:function(){this.searchTextData=this.searchText.data("placeholder")},setEvents:function(){var t=this;this.searchText.on("keyup keydown change input",function(){t.setSearchButton(this.value.trim().length)}),this.clearButton.on("click",function(){t.clearSearch()}),e(window).on(WILEY.states.medium.matched,function(){t.setPlaceholder(1)}),e(window).on(WILEY.states.medium.unmatched,function(){t.setPlaceholder(0)})},setSearchButton:function(e){e>0?(this.searchButton.removeAttr("disabled"),this.searchButton.removeClass("disabled")):(this.searchButton.attr("disabled","disabled"),this.searchButton.addClass("disabled"))},clearSearch:function(){this.searchText.val(""),this.setSearchButton()},setPlaceholder:function(e){this.searchText.attr("placeholder",this.searchTextData[e])}};return{init:function(e){r.constructor(e)}}}),WILEY.define("mobileNav",["jquery"],function(e){var t={defaults:{animationTime:Modernizr.csstransitions?350:0,eventType:Modernizr.touch?"touchstart":"click",outerClickNamespace:".mobileOuterClick"},init:function(t,n){this.element=e(t),this.options=e.extend({},this.defaults,n),this.setElements(),this.setEvents()},setElements:function(){this.subNav=e(".js-sub-nav",this.element),this.subNavTopic=e(".prim-nav__sub-nav-topic",this.element),this.container=e(".prim-nav-container"),this.navTrigger=e(".button--menu",this.container),this.searchTrigger=e(".button--menu-search",this.container),this.searchContainer=e(".search-wrap",this.container)},setEvents:function(){var t=this;this.subNav.on("click",function(n){n.preventDefault();var r=e(this).parent().next();e(".button--back",r).length===0&&r.prepend(e('<button class="button button--close-style1">Close</button><a href="#0" class="button--back">Back</a><h2 class="prim-nav__header js-mobile-sub">'+e(this).text()+"</h2>")),t.element.addClass("prim-nav__sub-container--sub-open"),r.addClass("prim-nav__menu-wrapper-open prim-nav__menu-sub-animation")}),this.subNavTopic.on("click",function(n){n.preventDefault();var r=e(this).next(),i=e(this).parents(".topics-menu"),s;clearTimeout(s),e(".button--back",r).length===0&&r.prepend(e('<button class="button button--close-style1">Close</button><a href="#0" class="button--back">Back</a><h4 class="prim-nav__header js-mobile-sub">'+e(this).text()+"</h4>")),e(".prim-nav__menu-sub-topic-open",i).removeClass("prim-nav__menu-sub-topic-open"),i.addClass("prim-nav__sub-container--sub-topics-open prim-nav__sub-container--sub-topics-open-animation"),r.addClass("prim-nav__menu-sub-topic-open"),s=setTimeout(function(){i.addClass("prim-nav__sub-container--sub-topics-open-animation-end")},t.options.animationTime)}),this.searchContainer.hasClass("search-async")&&this.element.on("click",".topics-menu .prim-nav__menu-sub-inner a",function(e){e.preventDefault(),t.resetNavigation()}),this.element.on("click",".button--back",function(e){e.preventDefault(),e.stopImmediatePropagation(),t.setBackButton()}),this.element.on("click",".button--close-style1",function(e){e.preventDefault(),t.resetNavigation()}),this.navTrigger.on("click",function(n){n.stopPropagation(),n.preventDefault(),e("html").addClass("prim-nav-open prim-nav-open--animation"),t.container.addClass("prim-nav__menu-open"),e(document).on(t.options.eventType+t.options.outerClickNamespace,function(n){!e(n.target).closest(t.element).length&&!e(n.target).hasClass("button--menu")&&(n.preventDefault(),n.stopImmediatePropagation(),t.resetNavigation())})}),this.searchTrigger.on("click",function(e){e.stopPropagation(),e.preventDefault(),t.searchContainer.toggleClass("search-wrap--is-visible")}),e(window).on(WILEY.states.medium.unmatched,function(){t.resetNavigation()})},setBackButton:function(){var t;clearTimeout(t),e(".topics-menu").hasClass("prim-nav__sub-container--sub-topics-open")?(e(".topics-menu").removeClass("prim-nav__sub-container--sub-topics-open prim-nav__sub-container--sub-topics-open-animation-end"),t=setTimeout(function(){e(".topics-menu").removeClass("prim-nav__sub-container--sub-topics-open-animation")},this.options.animationTime)):(e(".prim-nav").find(".prim-nav__sub-container, .prim-nav__wrapper").removeClass("prim-nav__sub-container--sub-open"),e(".prim-nav__menu-sub").removeClass("prim-nav__menu-wrapper-open"),t=setTimeout(function(){e(".prim-nav__menu-sub").removeClass("prim-nav__menu-sub-animation")},this.options.animationTime))},resetNavigation:function(){var t;clearTimeout(t),this.container.removeClass("prim-nav__menu-open"),e("html").removeClass("prim-nav-open"),t=setTimeout(function(){e(".prim-nav").find(".prim-nav__sub-container, .prim-nav__wrapper").removeClass("prim-nav__sub-container--sub-open"),e(".topics-menu").removeClass("prim-nav__sub-container--sub-topics-open prim-nav__sub-container--sub-topics-open-animation prim-nav__sub-container--sub-topics-open-animation-end"),e(".prim-nav__menu-sub").removeClass("prim-nav__menu-sub-animation prim-nav__menu-wrapper-open"),e("html").removeClass("prim-nav-open--animation")},this.options.animationTime),e(document).off(".mobileOuterClick"),e(".prim-nav__sub-container").removeClass("prim-nav__sub-container--sub-open"),e(".js-prim-nav__tab").removeClass("js-prim-nav__tab--open")}};return{init:function(e){t.init(e)}}}),WILEY.define("utilityFunctions",[],function(){var e={};return{loadCss:function(e){var t,n=document.getElementsByTagName("link"),r=n.length;for(t=0;t<r;t++)if(n[t].getAttribute("href")===e)return;WILEY.console("Loading CSS file dependancy... "+e);var i=document.createElement("link");i.type="text/css",i.rel="stylesheet",i.href=e,document.getElementsByTagName("head")[0].appendChild(i)},browserEqualizer:function(){String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")},String.prototype.ltrim=function(){return this.replace(/^\s+/,"")},String.prototype.rtrim=function(){return this.replace(/\s+$/,"")},String.prototype.fulltrim=function(){return this.replace(/(?:(?:^|\n)\s+|\s+(?:$|\n))/g,"").replace(/\s+/g," ")}),Array.prototype.indexOf||(Array.prototype.indexOf=function(e){"use strict";if(this===null)throw new TypeError;var t=Object(this),n=t.length>>>0;if(n===0)return-1;var r=0;arguments.length>1&&(r=Number(arguments[1]),r!=r?r=0:r!==0&&r!=Infinity&&r!=-Infinity&&(r=(r>0||-1)*Math.floor(Math.abs(r))));if(r>=n)return-1;var i=r>=0?r:Math.max(n-Math.abs(r),0);for(;i<n;i++)if(i in t&&t[i]===e)return i;return-1}),document.getElementsByClassName||(document.getElementsByClassName=function(e){var t=document,n,r,i,s=[];if(t.querySelectorAll)return t.querySelectorAll("."+e);if(t.evaluate){r=".//*[contains(concat(' ', @class, ' '), ' "+e+" ')]",n=t.evaluate(r,t,null,0,null);while(i=n.iterateNext())s.push(i)}else{n=t.getElementsByTagName("*"),r=new RegExp("(^|\\s)"+e+"(\\s|$)");for(i=0;i<n.length;i++)r.test(n[i].className)&&s.push(n[i])}return s})},genTimeStamp:function(){var e=new Date,t=Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds());return t},objGen:function(e){var t=Object({}),n=Array(),r,i,s,o;n=e.split(","),r=n.length;for(i=0;i<r;i++)o=n[i],t[i]=o.trim();return t},getElementByAttribute:function(e,t,n){n=n||document.body;if(this.hasAttr(n,e)&&n.getAttribute(e)===t)return n;var r=n.children,i;for(var s=r.length;s--;){i=this.getElementByAttribute(e,t,r[s]);if(i)return i}return null},hasAttr:function(e,t){return e.hasAttribute?e.hasAttribute(t):e[t]!==undefined},widgetAjax:function(t,n,r,i,s,o,u,a,f,l){WILEY.require(["jquery"],function(c){var h=c(document.createElement("div"));h.addClass(u),l==="before"?h.insertBefore(a):h.prependTo(a);if(e[f])return h.remove(),o(e[f]);var p=c.ajax({url:t,data:n,type:r,dataType:i,async:s,cache:!0,success:[function(){h.remove()},o,function(t){f!==undefined&&(e[f]=t)}],error:function(e){h.remove(),c(window).trigger("wiley:widget-ajax-error",[e])}});return p})},smoothScroll:function(e,t){t=t||500,WILEY.require(["jquery"],function(n){n("html, body").animate({scrollTop:e.offset().top},t)})},getQueryString:function(e){var t=window.location.search.substring(1),n=t.split("&"),r,i;for(i=0;i<n.length;i++){r=n[i].split("=");if(r[0]==e)return r[1]}return!1}}}),WILEY.define("primNav",["jquery","state"],function(e){"use strict";e(window).one(WILEY.states.medium.matched,function(){WILEY.require(["mobileNav"],function(t){t.init(e(".prim-nav__wrapper")),WILEY.cdn&&WILEY.require(["utilityFunctions"],function(e){e.loadCss(WILEY.cdn+"css/widgets/mobile-nav.css?"+WILEY.version)})})});var t={defaults:{elements:{tabs:".js-prim-nav__tab",menus:".prim-nav__menu-sub",tabsWrapper:".prim-nav__wrapper"},classnames:{tabOpen:"js-prim-nav__tab--open",menuOpen:"prim-nav__menu-sub--open"}},constructor:function(t,n){this.element=e(t),this.options=e.extend({},this.defaults,n),this.setElements(),this.setEvents()},setElements:function(){this.tabs=e(this.options.elements.tabs,this.element),this.menus=e(this.options.elements.menus,this.element),this.menuLinks=e("a",this.menus)},setEvents:function(){var t=this;e(document).on("click",function(n){e(n.target).closest(t.options.elements.tabsWrapper).length||t.closeAll()}),this.tabs.on("click",function(n){n.preventDefault();var r=e(this),i=r.next();r.hasClass(t.options.classnames.tabOpen)||t.closeAll(),r.toggleClass(t.options.classnames.tabOpen),i.toggleClass(t.options.classnames.menuOpen)}),this.menuLinks.on("click",function(){t.closeAll()})},closeAll:function(){this.tabs.removeClass(this.options.classnames.tabOpen),this.menus.removeClass(this.options.classnames.menuOpen)}};return{init:function(e,n){t.constructor(e,n)}}}),WILEY.define("wiley-esa",function(){});