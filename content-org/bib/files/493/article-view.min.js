(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){var adrevive=require("shared/views/components/revive-responsive-pagescan"),pdshelper=require("shared/views/components/pds-responsive-helper"),pagescan=require("shared/views/components/page-scan"),citationtools=require("shared/views/components/citation-tools"),starevents=require("shared/views/analytics/counter/counter-article-view"),bannertoggle=require("shared/views/components/shelf-banner-toggle"),v2citationtools=require("shared/views/components/v2/citation-tools");require("foundation5/foundation.accordion");require("foundation5/foundation.alert");require("thumbsecho");(function(){"use strict";$(function(){var $citationtools=$("#citation-tools-drop"),hash=window.location.hash,thumbs_init=function(hash){echo.detach();echo.init()},has_abstract=$(".abstract").length,filter_hash=function(hash){if(hash.indexOf("fndtn")>0){hash=hash.replace("fndtn-","")}return hash};if(hash){hash=filter_hash(hash);var hash_match=false;$(".tabs a").each(function(){if($(this).attr("href")===hash){hash_match=true;return false}});if(!hash_match){hash="";if(!$("#full_text_tab_contents, #pdf_only_tab_contents").length){window.location.hash="page_scan_tab_contents"}else{window.location.hash=""}}}require("foundation5/foundation.tab");if($("#pss_banner, #no_access, #rr_banner").length){bannertoggle.init()}citationtools.init(window.location.search,{id:$citationtools.data("doi"),title:$citationtools.data("title")});if(hash==="#page_thumbnails_tab_contents"){thumbs_init(hash)}$(window).on("hashchange",function(){var hash=window.location.hash;hash=filter_hash(hash);if(hash==="#page_thumbnails_tab_contents"){thumbs_init(hash)}});starevents.init(window.starData,window.location.href,hash,has_abstract);pdshelper.init("#pds-mobile-place-holder");v2citationtools.init();if($("#page_scan_tab_contents .revive-ad").find("div[id^='beacon_']").length){adrevive.init($("#page_scan_tab_contents .revive-ad"))}$(document).foundation("tab","reflow");if(!$("#full_text_tab_contents, #pdf_only_tab_contents").length){pagescan.init()}})})()},{"foundation5/foundation.accordion":3,"foundation5/foundation.alert":4,"foundation5/foundation.tab":5,"shared/views/analytics/counter/counter-article-view":11,"shared/views/components/citation-tools":12,"shared/views/components/page-scan":15,"shared/views/components/pds-responsive-helper":16,"shared/views/components/revive-responsive-pagescan":18,"shared/views/components/shelf-banner-toggle":19,"shared/views/components/v2/citation-tools":23,thumbsecho:10}],2:[function(require,module,exports){require("shared/models/siteVars");module.exports={eventNames:{small:"windowResizeToSmall",medium:"windowResizeToMedium",large:"windowResizeToLarge",xlarge:"windowResizeToXLarge"},isTouchDevice:function(){return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0},browserDoesInterpretMQ:function(){return Modernizr.mq("only all")},init:function(){this.lastWindowSizeIsSmall=this.isWindowSizeSmall();this.initResizeController()},currentSize:function(){var size="";if(this.isWindowSizeSmall()){size="small"}else if(this.isWindowSizeMedium()){size="medium"}else if(this.isWindowSizeLarge()){size="large"}else{size="xlarge"}return size},isWindowSizeSmall:function(){return window.innerWidth<=window.jstor.mediaQueryBreakpoints.small},isWindowSizeMedium:function(){return window.innerWidth<=window.jstor.mediaQueryBreakpoints.medium},isWindowSizeLarge:function(){return window.innerWidth<=window.jstor.mediaQueryBreakpoints.large},isWindowSizeXLarge:function(){return window.innerWidth>=window.jstor.mediaQueryBreakpoints.xlarge},initResizeController:function(){window.checkWindowSizeTimer=0;this.previousWindowSize=this.currentSize();var self=this;if(this.browserDoesInterpretMQ()){$(window).on("resize",function(){clearTimeout(window.checkWindowSizeTimer);window.checkWindowSizeTimer=setTimeout(function(){var currentSize=self.currentSize();if(currentSize!==self.previousWindowSize){$(document).trigger(self.eventNames[currentSize]);self.previousWindowSize=currentSize}},100)})}}}},{"shared/models/siteVars":7}],3:[function(require,module,exports){(function($,window,document,undefined){"use strict";Foundation.libs.accordion={name:"accordion",version:"5.5.3",settings:{content_class:"content",active_class:"active",multi_expand:false,toggleable:true,callback:function(){}},init:function(scope,method,options){this.bindings(method,options)},events:function(instance){var self=this;var S=this.S;self.create(this.S(instance));S(this.scope).off(".fndtn.accordion").on("click.fndtn.accordion","["+this.attr_name()+"] > dd > a, ["+this.attr_name()+"] > li > a",function(e){var accordion=S(this).closest("["+self.attr_name()+"]"),groupSelector=self.attr_name()+"="+accordion.attr(self.attr_name()),settings=accordion.data(self.attr_name(true)+"-init")||self.settings,target=S("#"+this.href.split("#")[1]),aunts=$("> dd, > li",accordion),siblings=aunts.children("."+settings.content_class),active_content=siblings.filter("."+settings.active_class);e.preventDefault();if(accordion.attr(self.attr_name())){siblings=siblings.add("["+groupSelector+"] dd > "+"."+settings.content_class+", ["+groupSelector+"] li > "+"."+settings.content_class);aunts=aunts.add("["+groupSelector+"] dd, ["+groupSelector+"] li")}if(settings.toggleable&&target.is(active_content)){target.parent("dd, li").toggleClass(settings.active_class,false);target.toggleClass(settings.active_class,false);S(this).attr("aria-expanded",function(i,attr){return attr==="true"?"false":"true"});settings.callback(target);target.triggerHandler("toggled",[accordion]);accordion.triggerHandler("toggled",[target]);return}if(!settings.multi_expand){siblings.removeClass(settings.active_class);aunts.removeClass(settings.active_class);aunts.children("a").attr("aria-expanded","false")}target.addClass(settings.active_class).parent().addClass(settings.active_class);settings.callback(target);target.triggerHandler("toggled",[accordion]);accordion.triggerHandler("toggled",[target]);S(this).attr("aria-expanded","true")})},create:function($instance){var self=this,accordion=$instance,aunts=$("> .accordion-navigation",accordion),settings=accordion.data(self.attr_name(true)+"-init")||self.settings;aunts.children("a").attr("aria-expanded","false");aunts.has("."+settings.content_class+"."+settings.active_class).addClass(settings.active_class).children("a").attr("aria-expanded","true");if(settings.multi_expand){$instance.attr("aria-multiselectable","true")}},toggle:function(options){var options=typeof options!=="undefined"?options:{};var selector=typeof options.selector!=="undefined"?options.selector:"";var toggle_state=typeof options.toggle_state!=="undefined"?options.toggle_state:"";var $accordion=typeof options.$accordion!=="undefined"?options.$accordion:this.S(this.scope).closest("["+this.attr_name()+"]");var $items=$accordion.find("> dd"+selector+", > li"+selector);if($items.length<1){if(window.console){console.error("Selection not found.",selector)}return false}var S=this.S;var active_class=this.settings.active_class;$items.each(function(){var $item=S(this);var is_active=$item.hasClass(active_class);if(is_active&&toggle_state==="close"||!is_active&&toggle_state==="open"||toggle_state===""){$item.find("> a").trigger("click.fndtn.accordion")}})},open:function(options){var options=typeof options!=="undefined"?options:{};options.toggle_state="open";this.toggle(options)},close:function(options){var options=typeof options!=="undefined"?options:{};options.toggle_state="close";this.toggle(options)},off:function(){},reflow:function(){}}})(jQuery,window,window.document)},{}],4:[function(require,module,exports){(function($,window,document,undefined){"use strict";Foundation.libs.alert={name:"alert",version:"5.5.3",settings:{callback:function(){}},init:function(scope,method,options){this.bindings(method,options)},events:function(){var self=this,S=this.S;$(this.scope).off(".alert").on("click.fndtn.alert","["+this.attr_name()+"] .close",function(e){var alertBox=S(this).closest("["+self.attr_name()+"]"),settings=alertBox.data(self.attr_name(true)+"-init")||self.settings;e.preventDefault();if(Modernizr.csstransitions){alertBox.addClass("alert-close");alertBox.on("transitionend webkitTransitionEnd oTransitionEnd",function(e){S(this).trigger("close.fndtn.alert").remove();settings.callback()})}else{alertBox.fadeOut(300,function(){S(this).trigger("close.fndtn.alert").remove();settings.callback()})}})},reflow:function(){}}})(jQuery,window,window.document)},{}],5:[function(require,module,exports){(function($,window,document,undefined){"use strict";Foundation.libs.tab={name:"tab",version:"5.5.3",settings:{active_class:"active",callback:function(){},deep_linking:false,scroll_to_content:true,is_hover:false},default_tab_hashes:[],init:function(scope,method,options){var self=this,S=this.S;S("["+this.attr_name()+"] > .active > a",this.scope).each(function(){self.default_tab_hashes.push(this.hash)});this.bindings(method,options);this.handle_location_hash_change()},events:function(){var self=this,S=this.S;var usual_tab_behavior=function(e,target){var settings=S(target).closest("["+self.attr_name()+"]").data(self.attr_name(true)+"-init");if(!settings.is_hover||Modernizr.touch){var keyCode=e.keyCode||e.which;if(keyCode!==9){e.preventDefault();e.stopPropagation()}self.toggle_active_tab(S(target).parent())}};S(this.scope).off(".tab").on("keydown.fndtn.tab","["+this.attr_name()+"] > * > a",function(e){var keyCode=e.keyCode||e.which;if(keyCode===13||keyCode===32){var el=this;usual_tab_behavior(e,el)}}).on("click.fndtn.tab","["+this.attr_name()+"] > * > a",function(e){var el=this;usual_tab_behavior(e,el)}).on("mouseenter.fndtn.tab","["+this.attr_name()+"] > * > a",function(e){var settings=S(this).closest("["+self.attr_name()+"]").data(self.attr_name(true)+"-init");if(settings.is_hover){self.toggle_active_tab(S(this).parent())}});S(window).on("hashchange.fndtn.tab",function(e){e.preventDefault();self.handle_location_hash_change()})},handle_location_hash_change:function(){var self=this,S=this.S;S("["+this.attr_name()+"]",this.scope).each(function(){var settings=S(this).data(self.attr_name(true)+"-init");if(settings.deep_linking){var hash;if(settings.scroll_to_content){hash=self.scope.location.hash}else{hash=self.scope.location.hash.replace("fndtn-","")}if(hash!=""){var hash_element=S(hash);if(hash_element.hasClass("content")&&hash_element.parent().hasClass("tabs-content")){self.toggle_active_tab($("["+self.attr_name()+"] > * > a[href="+hash+"]").parent())}else{var hash_tab_container_id=hash_element.closest(".content").attr("id");if(hash_tab_container_id!=undefined){self.toggle_active_tab($("["+self.attr_name()+"] > * > a[href=#"+hash_tab_container_id+"]").parent(),hash)}}}else{for(var ind=0;ind<self.default_tab_hashes.length;ind++){self.toggle_active_tab($("["+self.attr_name()+"] > * > a[href="+self.default_tab_hashes[ind]+"]").parent())}}}})},toggle_active_tab:function(tab,location_hash){var self=this,S=self.S,tabs=tab.closest("["+this.attr_name()+"]"),tab_link=tab.find("a"),anchor=tab.children("a").first(),target_hash="#"+anchor.attr("href").split("#")[1],target=S(target_hash),siblings=tab.siblings(),settings=tabs.data(this.attr_name(true)+"-init"),interpret_keyup_action=function(e){var $original=$(this);var $prev=$(this).parents("li").prev().children('[role="tab"]');var $next=$(this).parents("li").next().children('[role="tab"]');var $target;switch(e.keyCode){case 37:$target=$prev;break;case 39:$target=$next;break;default:$target=false;break}if($target.length){$original.attr({tabindex:"-1","aria-selected":null});$target.attr({tabindex:"0","aria-selected":true}).focus()}$('[role="tabpanel"]').attr("aria-hidden","true");$("#"+$(document.activeElement).attr("href").substring(1)).attr("aria-hidden",null)},go_to_hash=function(hash){var default_hash=settings.scroll_to_content?self.default_tab_hashes[0]:"fndtn-"+self.default_tab_hashes[0].replace("#","");if(hash!==default_hash||window.location.hash){window.location.hash=hash}};if(anchor.data("tab-content")){target_hash="#"+anchor.data("tab-content").split("#")[1];target=S(target_hash)}if(settings.deep_linking){if(settings.scroll_to_content){go_to_hash(location_hash||target_hash);if(location_hash==undefined||location_hash==target_hash){tab.parent()[0].scrollIntoView()}else{S(target_hash)[0].scrollIntoView()}}else{if(location_hash!=undefined){go_to_hash("fndtn-"+location_hash.replace("#",""))}else{go_to_hash("fndtn-"+target_hash.replace("#",""))}}}tab.addClass(settings.active_class).triggerHandler("opened");tab_link.attr({"aria-selected":"true",tabindex:0});siblings.removeClass(settings.active_class);siblings.find("a").attr({"aria-selected":"false"});target.siblings().removeClass(settings.active_class).attr({"aria-hidden":"true"});target.addClass(settings.active_class).attr("aria-hidden","false").removeAttr("tabindex");settings.callback(tab);target.triggerHandler("toggled",[target]);tabs.triggerHandler("toggled",[tab]);tab_link.off("keydown").on("keydown",interpret_keyup_action)},data_attr:function(str){if(this.namespace.length>0){return this.namespace+"-"+str}return str},off:function(){},reflow:function(){}}})(jQuery,window,window.document)},{}],6:[function(require,module,exports){(function($,window,document,undefined){"use strict";Foundation.libs.tooltip={name:"tooltip",version:"5.5.3",settings:{additional_inheritable_classes:[],tooltip_class:".tooltip",append_to:"body",touch_close_text:"Tap To Close",disable_for_touch:false,hover_delay:200,fade_in_duration:150,fade_out_duration:150,show_on:"all",tip_template:function(selector,content){return'<span data-selector="'+selector+'" id="'+selector+'" class="'+Foundation.libs.tooltip.settings.tooltip_class.substring(1)+'" role="tooltip">'+content+'<span class="nub"></span></span>'}},cache:{},init:function(scope,method,options){Foundation.inherit(this,"random_str");this.bindings(method,options)},should_show:function(target,tip){var settings=$.extend({},this.settings,this.data_options(target));if(settings.show_on==="all"){return true}else if(this.small()&&settings.show_on==="small"){return true}else if(this.medium()&&settings.show_on==="medium"){return true}else if(this.large()&&settings.show_on==="large"){return true}return false},medium:function(){return matchMedia(Foundation.media_queries["medium"]).matches},large:function(){return matchMedia(Foundation.media_queries["large"]).matches},events:function(instance){var self=this,S=self.S;self.create(this.S(instance));function _startShow(elt,$this,immediate){if(elt.timer){return}if(immediate){elt.timer=null;self.showTip($this)}else{elt.timer=setTimeout(function(){elt.timer=null;self.showTip($this)}.bind(elt),self.settings.hover_delay)}}function _startHide(elt,$this){if(elt.timer){clearTimeout(elt.timer);elt.timer=null}self.hide($this)}$(this.scope).off(".tooltip").on("mouseenter.fndtn.tooltip mouseleave.fndtn.tooltip touchstart.fndtn.tooltip MSPointerDown.fndtn.tooltip","["+this.attr_name()+"]",function(e){var $this=S(this),settings=$.extend({},self.settings,self.data_options($this)),is_touch=false;if(Modernizr.touch&&/touchstart|MSPointerDown/i.test(e.type)&&S(e.target).is("a")){return false}if(/mouse/i.test(e.type)&&self.ie_touch(e)){return false}if($this.hasClass("open")){if(Modernizr.touch&&/touchstart|MSPointerDown/i.test(e.type)){e.preventDefault()}self.hide($this)}else{if(settings.disable_for_touch&&Modernizr.touch&&/touchstart|MSPointerDown/i.test(e.type)){return}else if(!settings.disable_for_touch&&Modernizr.touch&&/touchstart|MSPointerDown/i.test(e.type)){e.preventDefault();S(settings.tooltip_class+".open").hide();is_touch=true;if($(".open["+self.attr_name()+"]").length>0){var prevOpen=S($(".open["+self.attr_name()+"]")[0]);self.hide(prevOpen)}}if(/enter|over/i.test(e.type)){_startShow(this,$this)}else if(e.type==="mouseout"||e.type==="mouseleave"){_startHide(this,$this)}else{_startShow(this,$this,true)}}}).on("mouseleave.fndtn.tooltip touchstart.fndtn.tooltip MSPointerDown.fndtn.tooltip","["+this.attr_name()+"].open",function(e){if(/mouse/i.test(e.type)&&self.ie_touch(e)){return false}if($(this).data("tooltip-open-event-type")=="touch"&&e.type=="mouseleave"){return}else if($(this).data("tooltip-open-event-type")=="mouse"&&/MSPointerDown|touchstart/i.test(e.type)){self.convert_to_touch($(this))}else{_startHide(this,$(this))}}).on("DOMNodeRemoved DOMAttrModified","["+this.attr_name()+"]:not(a)",function(e){_startHide(this,S(this))})},ie_touch:function(e){return false},showTip:function($target){var $tip=this.getTip($target);if(this.should_show($target,$tip)){return this.show($target)}return},getTip:function($target){var selector=this.selector($target),settings=$.extend({},this.settings,this.data_options($target)),tip=null;if(selector){tip=this.S('span[data-selector="'+selector+'"]'+settings.tooltip_class)}return typeof tip==="object"?tip:false},selector:function($target){var dataSelector=$target.attr(this.attr_name())||$target.attr("data-selector");if(typeof dataSelector!="string"){dataSelector=this.random_str(6);$target.attr("data-selector",dataSelector).attr("aria-describedby",dataSelector)}return dataSelector},create:function($target){var self=this,settings=$.extend({},this.settings,this.data_options($target)),tip_template=this.settings.tip_template;if(typeof settings.tip_template==="string"&&window.hasOwnProperty(settings.tip_template)){tip_template=window[settings.tip_template]}var $tip=$(tip_template(this.selector($target),$("<div></div>").html($target.attr("title")).html())),classes=this.inheritable_classes($target);$tip.addClass(classes).appendTo(settings.append_to);if(Modernizr.touch){$tip.append('<span class="tap-to-close">'+settings.touch_close_text+"</span>");$tip.on("touchstart.fndtn.tooltip MSPointerDown.fndtn.tooltip",function(e){self.hide($target)})}$target.removeAttr("title").attr("title","")},reposition:function(target,tip,classes){var width,nub,nubHeight,nubWidth,objPos;tip.css("visibility","hidden").show();width=target.data("width");nub=tip.children(".nub");nubHeight=nub.outerHeight();nubWidth=nub.outerWidth();if(this.small()){tip.css({width:"100%"})}else{tip.css({width:width?width:"auto"})}objPos=function(obj,top,right,bottom,left,width){return obj.css({top:top?top:"auto",bottom:bottom?bottom:"auto",left:left?left:"auto",right:right?right:"auto"}).end()};var o_top=target.offset().top;var o_left=target.offset().left;var outerHeight=target.outerHeight();objPos(tip,o_top+outerHeight+10,"auto","auto",o_left);if(this.small()){objPos(tip,o_top+outerHeight+10,"auto","auto",12.5,$(this.scope).width());tip.addClass("tip-override");objPos(nub,-nubHeight,"auto","auto",o_left)}else{if(Foundation.rtl){nub.addClass("rtl");o_left=o_left+target.outerWidth()-tip.outerWidth()}objPos(tip,o_top+outerHeight+10,"auto","auto",o_left);if(nub.attr("style")){nub.removeAttr("style")}tip.removeClass("tip-override");var tip_outerHeight=tip.outerHeight();if(classes&&classes.indexOf("tip-top")>-1){if(Foundation.rtl){nub.addClass("rtl")}objPos(tip,o_top-tip_outerHeight,"auto","auto",o_left).removeClass("tip-override")}else if(classes&&classes.indexOf("tip-left")>-1){objPos(tip,o_top+outerHeight/2-tip_outerHeight/2,"auto","auto",o_left-tip.outerWidth()-nubHeight).removeClass("tip-override");nub.removeClass("rtl")}else if(classes&&classes.indexOf("tip-right")>-1){objPos(tip,o_top+outerHeight/2-tip_outerHeight/2,"auto","auto",o_left+target.outerWidth()+nubHeight).removeClass("tip-override");nub.removeClass("rtl")}}tip.css("visibility","visible").hide()},small:function(){return matchMedia(Foundation.media_queries.small).matches&&!matchMedia(Foundation.media_queries.medium).matches},inheritable_classes:function($target){var settings=$.extend({},this.settings,this.data_options($target)),inheritables=["tip-top","tip-left","tip-bottom","tip-right","radius","round"].concat(settings.additional_inheritable_classes),classes=$target.attr("class"),filtered=classes?$.map(classes.split(" "),function(el,i){if($.inArray(el,inheritables)!==-1){return el}}).join(" "):"";return $.trim(filtered)},convert_to_touch:function($target){var self=this,$tip=self.getTip($target),settings=$.extend({},self.settings,self.data_options($target));if($tip.find(".tap-to-close").length===0){$tip.append('<span class="tap-to-close">'+settings.touch_close_text+"</span>");$tip.on("click.fndtn.tooltip.tapclose touchstart.fndtn.tooltip.tapclose MSPointerDown.fndtn.tooltip.tapclose",function(e){self.hide($target)})}$target.data("tooltip-open-event-type","touch")},show:function($target){var $tip=this.getTip($target);if($target.data("tooltip-open-event-type")=="touch"){this.convert_to_touch($target)}this.reposition($target,$tip,$target.attr("class"));$target.addClass("open");$tip.fadeIn(this.settings.fade_in_duration)},hide:function($target){var $tip=this.getTip($target);$tip.fadeOut(this.settings.fade_out_duration,function(){$tip.find(".tap-to-close").remove();$tip.off("click.fndtn.tooltip.tapclose MSPointerDown.fndtn.tapclose");$target.removeClass("open")})},off:function(){var self=this;this.S(this.scope).off(".fndtn.tooltip");this.S(this.settings.tooltip_class).each(function(i){$("["+self.attr_name()+"]").eq(i).attr("title",$(this).text())}).remove()},reflow:function(){}}})(jQuery,window,window.document)},{}],7:[function(require,module,exports){window.jstor={};window.jstor.siteCatalystDataMap={eventsMap:{RegistrationBegin:"event2",RegistrationComplete:"event3",InternalSearch:"event4",SecondGenSearch:"event5",ZeroSearchResults:"event11",SequoiaSearchRedirect:"event12",ContentView:"event13",CitationSaved:"event14",CitationTracked:"event16",eTOCSignup:"event17",LogIn:"event18",LogOut:"event19",DownloadPDF:"event22",SavedSearch:"event23",RecentSearch:"event24",RegistrationError:"event27",InstitutionLogin:"event28",AddToShelf:"event29",OpenedFlyout:"event30",CustomLink:"event31",QuickView:"event33"},eVarsMap:{AuthenticationStatus:"eVar1",AuthorizationStatus:"eVar2",AutheNAuthZ:"eVar3",PageName:"eVar4",PreviousPageName:"eVar5",Subject:"eVar6",Discipline:"eVar7",JournalName:"eVar8",ArticleTitle:"eVar9",Publisher:"eVar10",Issue:"eVar11",InternalSearchKeywords:"eVar12",InternalSearchFromHomepage:"eVar13",InternalSearchResultsOrder:"eVar14",InternalSearchScope:"eVar15",BrowseMethod:"eVar16",ContentType:"eVar17",Title:"eVar18",Author:"eVar19",PubDate:"eVar20","Volume:Issue":"eVar21",DOI:"eVar22",ISBN:"eVar23",ISSN:"eVar24",ArticleAvailability:"eVar25",Volume:"eVar26",InstitutionalOrIndividualUser:"eVar27",TypeOfInstitution:"eVar28",NameOfInstitution:"eVar29",SaveSearchFrequency:"eVar30",SearchResultPageNumber:"eVar31",DocumentRankInPage:"eVar32",LinkLocation:"eVar33",MyJstorStatus:"eVar34",InfoIconLocation:"eVar35",ErrorType:"eVar36",ExternalLoginEntry:"eVar37",AdvancedSearchButtonLocation:"eVar38",BookTitle:"eVar39",BookSeries:"eVar40",LoginPageActivity:"eVar41",ChapterTitle:"eVar42",MyJstorLoginResult:"eVar43",Pamphlet:"eVar44",LinkName:"eVar45",QuickViewSuccess:"eVar48",ItemType:"eVar49",ContentAccessPerSession:"eVar50",ContentDescription:"eVar52",SearchType:"eVar53",InstitutionFinderName:"eVar56",InstitutionSearchName:"eVar57"},propsMap:{Discipline:"prop1",Journal:"prop2",ArticleTitle:"prop3",Publisher:"prop4",Issue:"prop5",ContentType:"prop6",PageLevelClicks:"prop7",ApplicationName:"prop9",SearchType:"prop11",ActionType:"prop13",JournalIssueNavigationType:"prop14",BrowsebyTitleLetter:"prop15",JournalPageNavigationType:"prop17",ArticleContent:"prop18",PageNameFromCustomLink:"prop19",BreadCrumbName:"prop20",EventName:"prop21",Path:"prop22",AccessToItem:"prop23",ReferenceLinks:"prop24",BookImpressions:"prop25",ItemType:"prop26",DDADidMoveBook:"prop27",ReviewImpressions:"prop28",NameOfInstitution:"prop29",PublisherOrAuthor:"prop30",References:"prop31",SassExperimentGroup:"prop34",JournalImpressions:"prop36",OmnitureVersion:"prop50",ASTestGeneral:"prop51",ASTestAddField:"prop52",ASTestDateRange:"prop53",ASTestPublicationTitle:"prop54",ASTestISBN:"prop55",ASTestDisciplineCheck:"prop56",ASTestPublicationCheck:"prop57",SRTestSearchResultsSelection:"prop58",SRTestContentTypeChosen:"prop59",SRTestPDFDownload:"prop60",SRTestSearchRanking:"prop61"}};window.jstor.mediaQueryBreakpoints={small:"560",medium:"760",large:"1024",xlarge:"1280"}},{}],8:[function(require,module,exports){(function(global){!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.Clipboard=t()}}(function(){var t,e,n;return function t(e,n,r){function o(a,c){if(!n[a]){if(!e[a]){var s="function"==typeof require&&require;if(!c&&s)return s(a,!0);if(i)return i(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var l=n[a]={exports:{}};e[a][0].call(l.exports,function(t){var n=e[a][1][t];return o(n?n:t)},l,l.exports,t,e,n,r)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<r.length;a++)o(r[a]);return o}({1:[function(t,e,n){var r=t("matches-selector");e.exports=function(t,e,n){for(var o=n?t:t.parentNode;o&&o!==document;){if(r(o,e))return o;o=o.parentNode}}},{"matches-selector":2}],2:[function(t,e,n){function r(t,e){if(i)return i.call(t,e);for(var n=t.parentNode.querySelectorAll(e),r=0;r<n.length;++r)if(n[r]==t)return!0;return!1}var o=Element.prototype,i=o.matchesSelector||o.webkitMatchesSelector||o.mozMatchesSelector||o.msMatchesSelector||o.oMatchesSelector;e.exports=r},{}],3:[function(t,e,n){function r(t,e,n,r){var i=o.apply(this,arguments);return t.addEventListener(n,i),{destroy:function(){t.removeEventListener(n,i)}}}function o(t,e,n,r){return function(n){var o=i(n.target,e,!0);o&&(Object.defineProperty(n,"target",{value:o}),r.call(t,n))}}var i=t("closest");e.exports=r},{closest:1}],4:[function(t,e,n){n.node=function(t){return void 0!==t&&t instanceof HTMLElement&&1===t.nodeType},n.nodeList=function(t){var e=Object.prototype.toString.call(t);return void 0!==t&&("[object NodeList]"===e||"[object HTMLCollection]"===e)&&"length"in t&&(0===t.length||n.node(t[0]))},n.string=function(t){return"string"==typeof t||t instanceof String},n.function=function(t){var e=Object.prototype.toString.call(t);return"[object Function]"===e}},{}],5:[function(t,e,n){function r(t,e,n){if(!t&&!e&&!n)throw new Error("Missing required arguments");if(!c.string(e))throw new TypeError("Second argument must be a String");if(!c.function(n))throw new TypeError("Third argument must be a Function");if(c.node(t))return o(t,e,n);if(c.nodeList(t))return i(t,e,n);if(c.string(t))return a(t,e,n);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")}function o(t,e,n){return t.addEventListener(e,n),{destroy:function(){t.removeEventListener(e,n)}}}function i(t,e,n){return Array.prototype.forEach.call(t,function(t){t.addEventListener(e,n)}),{destroy:function(){Array.prototype.forEach.call(t,function(t){t.removeEventListener(e,n)})}}}function a(t,e,n){return s(document.body,t,e,n)}var c=t("./is"),s=t("delegate");e.exports=r},{"./is":4,delegate:3}],6:[function(t,e,n){function r(t){var e;if("INPUT"===t.nodeName||"TEXTAREA"===t.nodeName)t.select(),e=t.value;else{var n=window.getSelection(),r=document.createRange();r.selectNodeContents(t),n.removeAllRanges(),n.addRange(r),e=n.toString()}return e}e.exports=r},{}],7:[function(t,e,n){function r(){}r.prototype={on:function(t,e,n){var r=this.e||(this.e={});return(r[t]||(r[t]=[])).push({fn:e,ctx:n}),this},once:function(t,e,n){function r(){o.off(t,r),e.apply(n,arguments)}var o=this;return r._=e,this.on(t,r,n)},emit:function(t){var e=[].slice.call(arguments,1),n=((this.e||(this.e={}))[t]||[]).slice(),r=0,o=n.length;for(r;o>r;r++)n[r].fn.apply(n[r].ctx,e);return this},off:function(t,e){var n=this.e||(this.e={}),r=n[t],o=[];if(r&&e)for(var i=0,a=r.length;a>i;i++)r[i].fn!==e&&r[i].fn._!==e&&o.push(r[i]);return o.length?n[t]=o:delete n[t],this}},e.exports=r},{}],8:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.__esModule=!0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=t("select"),c=r(a),s=function(){function t(e){o(this,t),this.resolveOptions(e),this.initSelection()}return t.prototype.resolveOptions=function t(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];this.action=e.action,this.emitter=e.emitter,this.target=e.target,this.text=e.text,this.trigger=e.trigger,this.selectedText=""},t.prototype.initSelection=function t(){if(this.text&&this.target)throw new Error('Multiple attributes declared, use either "target" or "text"');if(this.text)this.selectFake();else{if(!this.target)throw new Error('Missing required attributes, use either "target" or "text"');this.selectTarget()}},t.prototype.selectFake=function t(){var e=this;this.removeFake(),this.fakeHandler=document.body.addEventListener("click",function(){return e.removeFake()}),this.fakeElem=document.createElement("textarea"),this.fakeElem.style.position="absolute",this.fakeElem.style.left="-9999px",this.fakeElem.style.top=(window.pageYOffset||document.documentElement.scrollTop)+"px",this.fakeElem.setAttribute("readonly",""),this.fakeElem.value=this.text,document.body.appendChild(this.fakeElem),this.selectedText=c.default(this.fakeElem),this.copyText()},t.prototype.removeFake=function t(){this.fakeHandler&&(document.body.removeEventListener("click"),this.fakeHandler=null),this.fakeElem&&(document.body.removeChild(this.fakeElem),this.fakeElem=null)},t.prototype.selectTarget=function t(){this.selectedText=c.default(this.target),this.copyText()},t.prototype.copyText=function t(){var e=void 0;try{e=document.execCommand(this.action)}catch(n){e=!1}this.handleResult(e)},t.prototype.handleResult=function t(e){e?this.emitter.emit("success",{action:this.action,text:this.selectedText,trigger:this.trigger,clearSelection:this.clearSelection.bind(this)}):this.emitter.emit("error",{action:this.action,trigger:this.trigger,clearSelection:this.clearSelection.bind(this)})},t.prototype.clearSelection=function t(){this.target&&this.target.blur(),window.getSelection().removeAllRanges()},t.prototype.destroy=function t(){this.removeFake()},i(t,[{key:"action",set:function t(){var e=arguments.length<=0||void 0===arguments[0]?"copy":arguments[0];if(this._action=e,"copy"!==this._action&&"cut"!==this._action)throw new Error('Invalid "action" value, use either "copy" or "cut"')},get:function t(){return this._action}},{key:"target",set:function t(e){if(void 0!==e){if(!e||"object"!=typeof e||1!==e.nodeType)throw new Error('Invalid "target" value, use a valid Element');this._target=e}},get:function t(){return this._target}}]),t}();n.default=s,e.exports=n.default},{select:6}],9:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function a(t,e){var n="data-clipboard-"+t;
if(e.hasAttribute(n))return e.getAttribute(n)}n.__esModule=!0;var c=t("./clipboard-action"),s=r(c),u=t("tiny-emitter"),l=r(u),f=t("good-listener"),d=r(f),h=function(t){function e(n,r){o(this,e),t.call(this),this.resolveOptions(r),this.listenClick(n)}return i(e,t),e.prototype.resolveOptions=function t(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];this.action="function"==typeof e.action?e.action:this.defaultAction,this.target="function"==typeof e.target?e.target:this.defaultTarget,this.text="function"==typeof e.text?e.text:this.defaultText},e.prototype.listenClick=function t(e){var n=this;this.listener=d.default(e,"click",function(t){return n.onClick(t)})},e.prototype.onClick=function t(e){this.clipboardAction&&(this.clipboardAction=null),this.clipboardAction=new s.default({action:this.action(e.target),target:this.target(e.target),text:this.text(e.target),trigger:e.target,emitter:this})},e.prototype.defaultAction=function t(e){return a("action",e)},e.prototype.defaultTarget=function t(e){var n=a("target",e);return n?document.querySelector(n):void 0},e.prototype.defaultText=function t(e){return a("text",e)},e.prototype.destroy=function t(){this.listener.destroy(),this.clipboardAction&&(this.clipboardAction.destroy(),this.clipboardAction=null)},e}(l.default);n.default=h,e.exports=n.default},{"./clipboard-action":8,"good-listener":5,"tiny-emitter":7}]},{},[9])(9)})}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],9:[function(require,module,exports){(function(global){var __browserify_shim_require__=require;(function browserifyShim(module,exports,require,define,browserify_shim__define__module__export__){var Handlebars=function(){var __module4__=function(){"use strict";var __exports__;function SafeString(string){this.string=string}SafeString.prototype.toString=function(){return""+this.string};__exports__=SafeString;return __exports__}();var __module3__=function(__dependency1__){"use strict";var __exports__={};var SafeString=__dependency1__;var escape={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"};var badChars=/[&<>"'`]/g;var possible=/[&<>"'`]/;function escapeChar(chr){return escape[chr]||"&amp;"}function extend(obj,value){for(var key in value){if(Object.prototype.hasOwnProperty.call(value,key)){obj[key]=value[key]}}}__exports__.extend=extend;var toString=Object.prototype.toString;__exports__.toString=toString;var isFunction=function(value){return typeof value==="function"};if(isFunction(/x/)){isFunction=function(value){return typeof value==="function"&&toString.call(value)==="[object Function]"}}var isFunction;__exports__.isFunction=isFunction;var isArray=Array.isArray||function(value){return value&&typeof value==="object"?toString.call(value)==="[object Array]":false};__exports__.isArray=isArray;function escapeExpression(string){if(string instanceof SafeString){return string.toString()}else if(!string&&string!==0){return""}string=""+string;if(!possible.test(string)){return string}return string.replace(badChars,escapeChar)}__exports__.escapeExpression=escapeExpression;function isEmpty(value){if(!value&&value!==0){return true}else if(isArray(value)&&value.length===0){return true}else{return false}}__exports__.isEmpty=isEmpty;return __exports__}(__module4__);var __module5__=function(){"use strict";var __exports__;var errorProps=["description","fileName","lineNumber","message","name","number","stack"];function Exception(message,node){var line;if(node&&node.firstLine){line=node.firstLine;message+=" - "+line+":"+node.firstColumn}var tmp=Error.prototype.constructor.call(this,message);for(var idx=0;idx<errorProps.length;idx++){this[errorProps[idx]]=tmp[errorProps[idx]]}if(line){this.lineNumber=line;this.column=node.firstColumn}}Exception.prototype=new Error;__exports__=Exception;return __exports__}();var __module2__=function(__dependency1__,__dependency2__){"use strict";var __exports__={};var Utils=__dependency1__;var Exception=__dependency2__;var VERSION="1.3.0";__exports__.VERSION=VERSION;var COMPILER_REVISION=4;__exports__.COMPILER_REVISION=COMPILER_REVISION;var REVISION_CHANGES={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:">= 1.0.0"};__exports__.REVISION_CHANGES=REVISION_CHANGES;var isArray=Utils.isArray,isFunction=Utils.isFunction,toString=Utils.toString,objectType="[object Object]";function HandlebarsEnvironment(helpers,partials){this.helpers=helpers||{};this.partials=partials||{};registerDefaultHelpers(this)}__exports__.HandlebarsEnvironment=HandlebarsEnvironment;HandlebarsEnvironment.prototype={constructor:HandlebarsEnvironment,logger:logger,log:log,registerHelper:function(name,fn,inverse){if(toString.call(name)===objectType){if(inverse||fn){throw new Exception("Arg not supported with multiple helpers")}Utils.extend(this.helpers,name)}else{if(inverse){fn.not=inverse}this.helpers[name]=fn}},registerPartial:function(name,str){if(toString.call(name)===objectType){Utils.extend(this.partials,name)}else{this.partials[name]=str}}};function registerDefaultHelpers(instance){instance.registerHelper("helperMissing",function(arg){if(arguments.length===2){return undefined}else{throw new Exception("Missing helper: '"+arg+"'")}});instance.registerHelper("blockHelperMissing",function(context,options){var inverse=options.inverse||function(){},fn=options.fn;if(isFunction(context)){context=context.call(this)}if(context===true){return fn(this)}else if(context===false||context==null){return inverse(this)}else if(isArray(context)){if(context.length>0){return instance.helpers.each(context,options)}else{return inverse(this)}}else{return fn(context)}});instance.registerHelper("each",function(context,options){var fn=options.fn,inverse=options.inverse;var i=0,ret="",data;if(isFunction(context)){context=context.call(this)}if(options.data){data=createFrame(options.data)}if(context&&typeof context==="object"){if(isArray(context)){for(var j=context.length;i<j;i++){if(data){data.index=i;data.first=i===0;data.last=i===context.length-1}ret=ret+fn(context[i],{data:data})}}else{for(var key in context){if(context.hasOwnProperty(key)){if(data){data.key=key;data.index=i;data.first=i===0}ret=ret+fn(context[key],{data:data});i++}}}}if(i===0){ret=inverse(this)}return ret});instance.registerHelper("if",function(conditional,options){if(isFunction(conditional)){conditional=conditional.call(this)}if(!options.hash.includeZero&&!conditional||Utils.isEmpty(conditional)){return options.inverse(this)}else{return options.fn(this)}});instance.registerHelper("unless",function(conditional,options){return instance.helpers["if"].call(this,conditional,{fn:options.inverse,inverse:options.fn,hash:options.hash})});instance.registerHelper("with",function(context,options){if(isFunction(context)){context=context.call(this)}if(!Utils.isEmpty(context))return options.fn(context)});instance.registerHelper("log",function(context,options){var level=options.data&&options.data.level!=null?parseInt(options.data.level,10):1;instance.log(level,context)})}var logger={methodMap:{0:"debug",1:"info",2:"warn",3:"error"},DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,log:function(level,obj){if(logger.level<=level){var method=logger.methodMap[level];if(typeof console!=="undefined"&&console[method]){console[method].call(console,obj)}}}};__exports__.logger=logger;function log(level,obj){logger.log(level,obj)}__exports__.log=log;var createFrame=function(object){var obj={};Utils.extend(obj,object);return obj};__exports__.createFrame=createFrame;return __exports__}(__module3__,__module5__);var __module6__=function(__dependency1__,__dependency2__,__dependency3__){"use strict";var __exports__={};var Utils=__dependency1__;var Exception=__dependency2__;var COMPILER_REVISION=__dependency3__.COMPILER_REVISION;var REVISION_CHANGES=__dependency3__.REVISION_CHANGES;function checkRevision(compilerInfo){var compilerRevision=compilerInfo&&compilerInfo[0]||1,currentRevision=COMPILER_REVISION;if(compilerRevision!==currentRevision){if(compilerRevision<currentRevision){var runtimeVersions=REVISION_CHANGES[currentRevision],compilerVersions=REVISION_CHANGES[compilerRevision];throw new Exception("Template was precompiled with an older version of Handlebars than the current runtime. "+"Please update your precompiler to a newer version ("+runtimeVersions+") or downgrade your runtime to an older version ("+compilerVersions+").")}else{throw new Exception("Template was precompiled with a newer version of Handlebars than the current runtime. "+"Please update your runtime to a newer version ("+compilerInfo[1]+").")}}}__exports__.checkRevision=checkRevision;function template(templateSpec,env){if(!env){throw new Exception("No environment passed to template")}var invokePartialWrapper=function(partial,name,context,helpers,partials,data){var result=env.VM.invokePartial.apply(this,arguments);if(result!=null){return result}if(env.compile){var options={helpers:helpers,partials:partials,data:data};partials[name]=env.compile(partial,{data:data!==undefined},env);return partials[name](context,options)}else{throw new Exception("The partial "+name+" could not be compiled when running in runtime-only mode")}};var container={escapeExpression:Utils.escapeExpression,invokePartial:invokePartialWrapper,programs:[],program:function(i,fn,data){var programWrapper=this.programs[i];if(data){programWrapper=program(i,fn,data)}else if(!programWrapper){programWrapper=this.programs[i]=program(i,fn)}return programWrapper},merge:function(param,common){var ret=param||common;if(param&&common&&param!==common){ret={};Utils.extend(ret,common);Utils.extend(ret,param)}return ret},programWithDepth:env.VM.programWithDepth,noop:env.VM.noop,compilerInfo:null};return function(context,options){options=options||{};var namespace=options.partial?options:env,helpers,partials;if(!options.partial){helpers=options.helpers;partials=options.partials}var result=templateSpec.call(container,namespace,context,helpers,partials,options.data);if(!options.partial){env.VM.checkRevision(container.compilerInfo)}return result}}__exports__.template=template;function programWithDepth(i,fn,data){var args=Array.prototype.slice.call(arguments,3);var prog=function(context,options){options=options||{};return fn.apply(this,[context,options.data||data].concat(args))};prog.program=i;prog.depth=args.length;return prog}__exports__.programWithDepth=programWithDepth;function program(i,fn,data){var prog=function(context,options){options=options||{};return fn(context,options.data||data)};prog.program=i;prog.depth=0;return prog}__exports__.program=program;function invokePartial(partial,name,context,helpers,partials,data){var options={partial:true,helpers:helpers,partials:partials,data:data};if(partial===undefined){throw new Exception("The partial "+name+" could not be found")}else if(partial instanceof Function){return partial(context,options)}}__exports__.invokePartial=invokePartial;function noop(){return""}__exports__.noop=noop;return __exports__}(__module3__,__module5__,__module2__);var __module1__=function(__dependency1__,__dependency2__,__dependency3__,__dependency4__,__dependency5__){"use strict";var __exports__;var base=__dependency1__;var SafeString=__dependency2__;var Exception=__dependency3__;var Utils=__dependency4__;var runtime=__dependency5__;var create=function(){var hb=new base.HandlebarsEnvironment;Utils.extend(hb,base);hb.SafeString=SafeString;hb.Exception=Exception;hb.Utils=Utils;hb.VM=runtime;hb.template=function(spec){return runtime.template(spec,hb)};return hb};var Handlebars=create();Handlebars.create=create;__exports__=Handlebars;return __exports__}(__module2__,__module4__,__module5__,__module3__,__module6__);var __module7__=function(__dependency1__){"use strict";var __exports__;var Exception=__dependency1__;function LocationInfo(locInfo){locInfo=locInfo||{};this.firstLine=locInfo.first_line;this.firstColumn=locInfo.first_column;this.lastColumn=locInfo.last_column;this.lastLine=locInfo.last_line}var AST={ProgramNode:function(statements,inverseStrip,inverse,locInfo){var inverseLocationInfo,firstInverseNode;if(arguments.length===3){locInfo=inverse;inverse=null}else if(arguments.length===2){locInfo=inverseStrip;inverseStrip=null}LocationInfo.call(this,locInfo);this.type="program";this.statements=statements;this.strip={};if(inverse){firstInverseNode=inverse[0];if(firstInverseNode){inverseLocationInfo={first_line:firstInverseNode.firstLine,last_line:firstInverseNode.lastLine,last_column:firstInverseNode.lastColumn,first_column:firstInverseNode.firstColumn};this.inverse=new AST.ProgramNode(inverse,inverseStrip,inverseLocationInfo)}else{this.inverse=new AST.ProgramNode(inverse,inverseStrip)}this.strip.right=inverseStrip.left}else if(inverseStrip){this.strip.left=inverseStrip.right}},MustacheNode:function(rawParams,hash,open,strip,locInfo){LocationInfo.call(this,locInfo);this.type="mustache";this.strip=strip;if(open!=null&&open.charAt){var escapeFlag=open.charAt(3)||open.charAt(2);this.escaped=escapeFlag!=="{"&&escapeFlag!=="&"}else{this.escaped=!!open}if(rawParams instanceof AST.SexprNode){this.sexpr=rawParams}else{this.sexpr=new AST.SexprNode(rawParams,hash)}this.sexpr.isRoot=true;this.id=this.sexpr.id;this.params=this.sexpr.params;this.hash=this.sexpr.hash;this.eligibleHelper=this.sexpr.eligibleHelper;this.isHelper=this.sexpr.isHelper},SexprNode:function(rawParams,hash,locInfo){LocationInfo.call(this,locInfo);this.type="sexpr";this.hash=hash;var id=this.id=rawParams[0];var params=this.params=rawParams.slice(1);var eligibleHelper=this.eligibleHelper=id.isSimple;this.isHelper=eligibleHelper&&(params.length||hash)},PartialNode:function(partialName,context,strip,locInfo){LocationInfo.call(this,locInfo);this.type="partial";this.partialName=partialName;this.context=context;this.strip=strip},BlockNode:function(mustache,program,inverse,close,locInfo){LocationInfo.call(this,locInfo);if(mustache.sexpr.id.original!==close.path.original){throw new Exception(mustache.sexpr.id.original+" doesn't match "+close.path.original,this)}this.type="block";this.mustache=mustache;this.program=program;this.inverse=inverse;this.strip={left:mustache.strip.left,right:close.strip.right};(program||inverse).strip.left=mustache.strip.right;(inverse||program).strip.right=close.strip.left;if(inverse&&!program){this.isInverse=true}},ContentNode:function(string,locInfo){LocationInfo.call(this,locInfo);this.type="content";this.string=string},HashNode:function(pairs,locInfo){LocationInfo.call(this,locInfo);this.type="hash";this.pairs=pairs},IdNode:function(parts,locInfo){LocationInfo.call(this,locInfo);this.type="ID";var original="",dig=[],depth=0;for(var i=0,l=parts.length;i<l;i++){var part=parts[i].part;original+=(parts[i].separator||"")+part;if(part===".."||part==="."||part==="this"){if(dig.length>0){throw new Exception("Invalid path: "+original,this)}else if(part===".."){depth++}else{this.isScoped=true}}else{dig.push(part)}}this.original=original;this.parts=dig;this.string=dig.join(".");this.depth=depth;this.isSimple=parts.length===1&&!this.isScoped&&depth===0;this.stringModeValue=this.string},PartialNameNode:function(name,locInfo){LocationInfo.call(this,locInfo);this.type="PARTIAL_NAME";this.name=name.original},DataNode:function(id,locInfo){LocationInfo.call(this,locInfo);this.type="DATA";this.id=id},StringNode:function(string,locInfo){LocationInfo.call(this,locInfo);this.type="STRING";this.original=this.string=this.stringModeValue=string},IntegerNode:function(integer,locInfo){LocationInfo.call(this,locInfo);this.type="INTEGER";this.original=this.integer=integer;this.stringModeValue=Number(integer)},BooleanNode:function(bool,locInfo){LocationInfo.call(this,locInfo);this.type="BOOLEAN";this.bool=bool;this.stringModeValue=bool==="true"},CommentNode:function(comment,locInfo){LocationInfo.call(this,locInfo);this.type="comment";this.comment=comment}};__exports__=AST;return __exports__}(__module5__);var __module9__=function(){"use strict";var __exports__;var handlebars=function(){var parser={trace:function trace(){},yy:{},symbols_:{error:2,root:3,statements:4,EOF:5,program:6,simpleInverse:7,statement:8,openInverse:9,closeBlock:10,openBlock:11,mustache:12,partial:13,CONTENT:14,COMMENT:15,OPEN_BLOCK:16,sexpr:17,CLOSE:18,OPEN_INVERSE:19,OPEN_ENDBLOCK:20,path:21,OPEN:22,OPEN_UNESCAPED:23,CLOSE_UNESCAPED:24,OPEN_PARTIAL:25,partialName:26,partial_option0:27,sexpr_repetition0:28,sexpr_option0:29,dataName:30,param:31,STRING:32,INTEGER:33,BOOLEAN:34,OPEN_SEXPR:35,CLOSE_SEXPR:36,hash:37,hash_repetition_plus0:38,hashSegment:39,ID:40,EQUALS:41,DATA:42,pathSegments:43,SEP:44,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",14:"CONTENT",15:"COMMENT",16:"OPEN_BLOCK",18:"CLOSE",19:"OPEN_INVERSE",20:"OPEN_ENDBLOCK",22:"OPEN",23:"OPEN_UNESCAPED",24:"CLOSE_UNESCAPED",25:"OPEN_PARTIAL",32:"STRING",33:"INTEGER",34:"BOOLEAN",35:"OPEN_SEXPR",36:"CLOSE_SEXPR",40:"ID",41:"EQUALS",42:"DATA",44:"SEP"},productions_:[0,[3,2],[3,1],[6,2],[6,3],[6,2],[6,1],[6,1],[6,0],[4,1],[4,2],[8,3],[8,3],[8,1],[8,1],[8,1],[8,1],[11,3],[9,3],[10,3],[12,3],[12,3],[13,4],[7,2],[17,3],[17,1],[31,1],[31,1],[31,1],[31,1],[31,1],[31,3],[37,1],[39,3],[26,1],[26,1],[26,1],[30,2],[21,1],[43,3],[43,1],[27,0],[27,1],[28,0],[28,2],[29,0],[29,1],[38,1],[38,2]],performAction:function anonymous(yytext,yyleng,yylineno,yy,yystate,$$,_$){var $0=$$.length-1;switch(yystate){case 1:return new yy.ProgramNode($$[$0-1],this._$);break;case 2:return new yy.ProgramNode([],this._$);break;case 3:this.$=new yy.ProgramNode([],$$[$0-1],$$[$0],this._$);break;case 4:this.$=new yy.ProgramNode($$[$0-2],$$[$0-1],$$[$0],this._$);break;case 5:this.$=new yy.ProgramNode($$[$0-1],$$[$0],[],this._$);break;case 6:this.$=new yy.ProgramNode($$[$0],this._$);break;case 7:this.$=new yy.ProgramNode([],this._$);break;case 8:this.$=new yy.ProgramNode([],this._$);break;case 9:this.$=[$$[$0]];break;case 10:$$[$0-1].push($$[$0]);this.$=$$[$0-1];break;case 11:this.$=new yy.BlockNode($$[$0-2],$$[$0-1].inverse,$$[$0-1],$$[$0],this._$);break;case 12:this.$=new yy.BlockNode($$[$0-2],$$[$0-1],$$[$0-1].inverse,$$[$0],this._$);break;case 13:this.$=$$[$0];break;case 14:this.$=$$[$0];break;case 15:this.$=new yy.ContentNode($$[$0],this._$);break;case 16:this.$=new yy.CommentNode($$[$0],this._$);break;case 17:this.$=new yy.MustacheNode($$[$0-1],null,$$[$0-2],stripFlags($$[$0-2],$$[$0]),this._$);break;case 18:this.$=new yy.MustacheNode($$[$0-1],null,$$[$0-2],stripFlags($$[$0-2],$$[$0]),this._$);break;case 19:this.$={path:$$[$0-1],strip:stripFlags($$[$0-2],$$[$0])};break;case 20:this.$=new yy.MustacheNode($$[$0-1],null,$$[$0-2],stripFlags($$[$0-2],$$[$0]),this._$);break;case 21:this.$=new yy.MustacheNode($$[$0-1],null,$$[$0-2],stripFlags($$[$0-2],$$[$0]),this._$);break;case 22:this.$=new yy.PartialNode($$[$0-2],$$[$0-1],stripFlags($$[$0-3],$$[$0]),this._$);break;case 23:this.$=stripFlags($$[$0-1],$$[$0]);break;case 24:this.$=new yy.SexprNode([$$[$0-2]].concat($$[$0-1]),$$[$0],this._$);break;case 25:this.$=new yy.SexprNode([$$[$0]],null,this._$);break;case 26:this.$=$$[$0];break;case 27:this.$=new yy.StringNode($$[$0],this._$);break;case 28:this.$=new yy.IntegerNode($$[$0],this._$);break;case 29:this.$=new yy.BooleanNode($$[$0],this._$);break;case 30:this.$=$$[$0];break;case 31:$$[$0-1].isHelper=true;this.$=$$[$0-1];break;case 32:this.$=new yy.HashNode($$[$0],this._$);break;case 33:this.$=[$$[$0-2],$$[$0]];break;case 34:this.$=new yy.PartialNameNode($$[$0],this._$);break;case 35:this.$=new yy.PartialNameNode(new yy.StringNode($$[$0],this._$),this._$);break;case 36:this.$=new yy.PartialNameNode(new yy.IntegerNode($$[$0],this._$));break;case 37:this.$=new yy.DataNode($$[$0],this._$);break;case 38:this.$=new yy.IdNode($$[$0],this._$);break;case 39:$$[$0-2].push({part:$$[$0],separator:$$[$0-1]});this.$=$$[$0-2];break;case 40:this.$=[{part:$$[$0]}];break;case 43:this.$=[];break;case 44:$$[$0-1].push($$[$0]);break;case 47:this.$=[$$[$0]];break;case 48:$$[$0-1].push($$[$0]);break}},table:[{3:1,4:2,5:[1,3],8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],22:[1,13],23:[1,14],25:[1,15]},{1:[3]},{5:[1,16],8:17,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],22:[1,13],23:[1,14],25:[1,15]},{1:[2,2]},{5:[2,9],14:[2,9],15:[2,9],16:[2,9],19:[2,9],20:[2,9],22:[2,9],23:[2,9],25:[2,9]},{4:20,6:18,7:19,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,21],20:[2,8],22:[1,13],23:[1,14],25:[1,15]},{4:20,6:22,7:19,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,21],20:[2,8],22:[1,13],23:[1,14],25:[1,15]},{5:[2,13],14:[2,13],15:[2,13],16:[2,13],19:[2,13],20:[2,13],22:[2,13],23:[2,13],25:[2,13]},{5:[2,14],14:[2,14],15:[2,14],16:[2,14],19:[2,14],20:[2,14],22:[2,14],23:[2,14],25:[2,14]},{5:[2,15],14:[2,15],15:[2,15],16:[2,15],19:[2,15],20:[2,15],22:[2,15],23:[2,15],25:[2,15]},{5:[2,16],14:[2,16],15:[2,16],16:[2,16],19:[2,16],20:[2,16],22:[2,16],23:[2,16],25:[2,16]},{17:23,21:24,30:25,40:[1,28],42:[1,27],43:26},{17:29,21:24,30:25,40:[1,28],42:[1,27],43:26},{17:30,21:24,30:25,40:[1,28],42:[1,27],43:26},{17:31,21:24,30:25,40:[1,28],42:[1,27],43:26},{21:33,26:32,32:[1,34],33:[1,35],40:[1,28],43:26},{1:[2,1]},{5:[2,10],14:[2,10],15:[2,10],16:[2,10],19:[2,10],20:[2,10],22:[2,10],23:[2,10],25:[2,10]},{10:36,20:[1,37]},{4:38,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,7],22:[1,13],23:[1,14],25:[1,15]},{7:39,8:17,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,21],20:[2,6],22:[1,13],23:[1,14],25:[1,15]},{17:23,18:[1,40],21:24,30:25,40:[1,28],42:[1,27],43:26},{10:41,20:[1,37]},{18:[1,42]},{18:[2,43],24:[2,43],28:43,32:[2,43],33:[2,43],34:[2,43],35:[2,43],36:[2,43],40:[2,43],42:[2,43]},{18:[2,25],24:[2,25],36:[2,25]},{18:[2,38],24:[2,38],32:[2,38],33:[2,38],34:[2,38],35:[2,38],36:[2,38],40:[2,38],42:[2,38],44:[1,44]},{21:45,40:[1,28],43:26},{18:[2,40],24:[2,40],32:[2,40],33:[2,40],34:[2,40],35:[2,40],36:[2,40],40:[2,40],42:[2,40],44:[2,40]},{18:[1,46]},{18:[1,47]},{24:[1,48]},{18:[2,41],21:50,27:49,40:[1,28],43:26},{18:[2,34],40:[2,34]},{18:[2,35],40:[2,35]},{18:[2,36],40:[2,36]},{5:[2,11],14:[2,11],15:[2,11],16:[2,11],19:[2,11],20:[2,11],22:[2,11],23:[2,11],25:[2,11]},{21:51,40:[1,28],43:26},{8:17,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,3],22:[1,13],23:[1,14],25:[1,15]},{4:52,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,5],22:[1,13],23:[1,14],25:[1,15]},{14:[2,23],15:[2,23],16:[2,23],19:[2,23],20:[2,23],22:[2,23],23:[2,23],25:[2,23]},{5:[2,12],14:[2,12],15:[2,12],16:[2,12],19:[2,12],20:[2,12],22:[2,12],23:[2,12],25:[2,12]},{14:[2,18],15:[2,18],16:[2,18],19:[2,18],20:[2,18],22:[2,18],23:[2,18],25:[2,18]},{18:[2,45],21:56,24:[2,45],29:53,30:60,31:54,32:[1,57],33:[1,58],34:[1,59],35:[1,61],36:[2,45],37:55,38:62,39:63,40:[1,64],42:[1,27],43:26},{40:[1,65]},{18:[2,37],24:[2,37],32:[2,37],33:[2,37],34:[2,37],35:[2,37],36:[2,37],40:[2,37],42:[2,37]},{14:[2,17],15:[2,17],16:[2,17],19:[2,17],20:[2,17],22:[2,17],23:[2,17],25:[2,17]},{5:[2,20],14:[2,20],15:[2,20],16:[2,20],19:[2,20],20:[2,20],22:[2,20],23:[2,20],25:[2,20]},{5:[2,21],14:[2,21],15:[2,21],16:[2,21],19:[2,21],20:[2,21],22:[2,21],23:[2,21],25:[2,21]},{18:[1,66]},{18:[2,42]},{18:[1,67]},{8:17,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,4],22:[1,13],23:[1,14],25:[1,15]},{18:[2,24],24:[2,24],36:[2,24]},{18:[2,44],24:[2,44],32:[2,44],33:[2,44],34:[2,44],35:[2,44],36:[2,44],40:[2,44],42:[2,44]},{18:[2,46],24:[2,46],36:[2,46]},{18:[2,26],24:[2,26],32:[2,26],33:[2,26],34:[2,26],35:[2,26],36:[2,26],40:[2,26],42:[2,26]},{18:[2,27],24:[2,27],32:[2,27],33:[2,27],34:[2,27],35:[2,27],36:[2,27],40:[2,27],42:[2,27]},{18:[2,28],24:[2,28],32:[2,28],33:[2,28],34:[2,28],35:[2,28],36:[2,28],40:[2,28],42:[2,28]},{18:[2,29],24:[2,29],32:[2,29],33:[2,29],34:[2,29],35:[2,29],36:[2,29],40:[2,29],42:[2,29]},{18:[2,30],24:[2,30],32:[2,30],33:[2,30],34:[2,30],35:[2,30],36:[2,30],40:[2,30],42:[2,30]},{17:68,21:24,30:25,40:[1,28],42:[1,27],43:26},{18:[2,32],24:[2,32],36:[2,32],39:69,40:[1,70]},{18:[2,47],24:[2,47],36:[2,47],40:[2,47]},{18:[2,40],24:[2,40],32:[2,40],33:[2,40],34:[2,40],35:[2,40],36:[2,40],40:[2,40],41:[1,71],42:[2,40],44:[2,40]},{18:[2,39],24:[2,39],32:[2,39],33:[2,39],34:[2,39],35:[2,39],36:[2,39],40:[2,39],42:[2,39],44:[2,39]},{5:[2,22],14:[2,22],15:[2,22],16:[2,22],19:[2,22],20:[2,22],22:[2,22],23:[2,22],25:[2,22]},{5:[2,19],14:[2,19],15:[2,19],16:[2,19],19:[2,19],20:[2,19],22:[2,19],23:[2,19],25:[2,19]},{36:[1,72]},{18:[2,48],24:[2,48],36:[2,48],40:[2,48]},{41:[1,71]},{21:56,30:60,31:73,32:[1,57],33:[1,58],34:[1,59],35:[1,61],40:[1,28],42:[1,27],43:26},{18:[2,31],24:[2,31],32:[2,31],33:[2,31],34:[2,31],35:[2,31],36:[2,31],40:[2,31],42:[2,31]},{18:[2,33],24:[2,33],36:[2,33],40:[2,33]}],defaultActions:{3:[2,2],16:[2,1],50:[2,42]},parseError:function parseError(str,hash){throw new Error(str)},parse:function parse(input){var self=this,stack=[0],vstack=[null],lstack=[],table=this.table,yytext="",yylineno=0,yyleng=0,recovering=0,TERROR=2,EOF=1;this.lexer.setInput(input);this.lexer.yy=this.yy;this.yy.lexer=this.lexer;this.yy.parser=this;if(typeof this.lexer.yylloc=="undefined")this.lexer.yylloc={};var yyloc=this.lexer.yylloc;lstack.push(yyloc);var ranges=this.lexer.options&&this.lexer.options.ranges;if(typeof this.yy.parseError==="function")this.parseError=this.yy.parseError;function popStack(n){stack.length=stack.length-2*n;vstack.length=vstack.length-n;lstack.length=lstack.length-n}function lex(){var token;token=self.lexer.lex()||1;if(typeof token!=="number"){token=self.symbols_[token]||token}return token}var symbol,preErrorSymbol,state,action,a,r,yyval={},p,len,newState,expected;while(true){state=stack[stack.length-1];if(this.defaultActions[state]){action=this.defaultActions[state]}else{if(symbol===null||typeof symbol=="undefined"){symbol=lex()}action=table[state]&&table[state][symbol]}if(typeof action==="undefined"||!action.length||!action[0]){var errStr="";if(!recovering){expected=[];for(p in table[state])if(this.terminals_[p]&&p>2){expected.push("'"+this.terminals_[p]+"'")}if(this.lexer.showPosition){errStr="Parse error on line "+(yylineno+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+expected.join(", ")+", got '"+(this.terminals_[symbol]||symbol)+"'"}else{errStr="Parse error on line "+(yylineno+1)+": Unexpected "+(symbol==1?"end of input":"'"+(this.terminals_[symbol]||symbol)+"'")}this.parseError(errStr,{text:this.lexer.match,token:this.terminals_[symbol]||symbol,line:this.lexer.yylineno,loc:yyloc,expected:expected})}}if(action[0]instanceof Array&&action.length>1){throw new Error("Parse Error: multiple actions possible at state: "+state+", token: "+symbol)}switch(action[0]){case 1:stack.push(symbol);vstack.push(this.lexer.yytext);lstack.push(this.lexer.yylloc);stack.push(action[1]);symbol=null;if(!preErrorSymbol){yyleng=this.lexer.yyleng;yytext=this.lexer.yytext;yylineno=this.lexer.yylineno;yyloc=this.lexer.yylloc;if(recovering>0)recovering--}else{symbol=preErrorSymbol;preErrorSymbol=null}break;case 2:len=this.productions_[action[1]][1];yyval.$=vstack[vstack.length-len];yyval._$={first_line:lstack[lstack.length-(len||1)].first_line,last_line:lstack[lstack.length-1].last_line,first_column:lstack[lstack.length-(len||1)].first_column,last_column:lstack[lstack.length-1].last_column};if(ranges){yyval._$.range=[lstack[lstack.length-(len||1)].range[0],lstack[lstack.length-1].range[1]]}r=this.performAction.call(yyval,yytext,yyleng,yylineno,this.yy,action[1],vstack,lstack);if(typeof r!=="undefined"){return r}if(len){stack=stack.slice(0,-1*len*2);vstack=vstack.slice(0,-1*len);lstack=lstack.slice(0,-1*len)}stack.push(this.productions_[action[1]][0]);vstack.push(yyval.$);lstack.push(yyval._$);newState=table[stack[stack.length-2]][stack[stack.length-1]];stack.push(newState);break;case 3:return true}}return true}};function stripFlags(open,close){return{left:open.charAt(2)==="~",right:close.charAt(0)==="~"||close.charAt(1)==="~"}}var lexer=function(){var lexer={EOF:1,parseError:function parseError(str,hash){if(this.yy.parser){this.yy.parser.parseError(str,hash)}else{throw new Error(str)}},setInput:function(input){this._input=input;this._more=this._less=this.done=false;this.yylineno=this.yyleng=0;this.yytext=this.matched=this.match="";this.conditionStack=["INITIAL"];this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0};if(this.options.ranges)this.yylloc.range=[0,0];this.offset=0;return this},input:function(){var ch=this._input[0];this.yytext+=ch;this.yyleng++;this.offset++;this.match+=ch;this.matched+=ch;var lines=ch.match(/(?:\r\n?|\n).*/g);if(lines){this.yylineno++;this.yylloc.last_line++}else{this.yylloc.last_column++}if(this.options.ranges)this.yylloc.range[1]++;this._input=this._input.slice(1);return ch},unput:function(ch){var len=ch.length;var lines=ch.split(/(?:\r\n?|\n)/g);this._input=ch+this._input;this.yytext=this.yytext.substr(0,this.yytext.length-len-1);this.offset-=len;var oldLines=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1);this.matched=this.matched.substr(0,this.matched.length-1);if(lines.length-1)this.yylineno-=lines.length-1;var r=this.yylloc.range;this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:lines?(lines.length===oldLines.length?this.yylloc.first_column:0)+oldLines[oldLines.length-lines.length].length-lines[0].length:this.yylloc.first_column-len};if(this.options.ranges){this.yylloc.range=[r[0],r[0]+this.yyleng-len]}return this},more:function(){this._more=true;return this},less:function(n){this.unput(this.match.slice(n))},pastInput:function(){var past=this.matched.substr(0,this.matched.length-this.match.length);return(past.length>20?"...":"")+past.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var next=this.match;if(next.length<20){next+=this._input.substr(0,20-next.length)}return(next.substr(0,20)+(next.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var pre=this.pastInput();var c=new Array(pre.length+1).join("-");return pre+this.upcomingInput()+"\n"+c+"^"},next:function(){if(this.done){return this.EOF}if(!this._input)this.done=true;var token,match,tempMatch,index,col,lines;if(!this._more){this.yytext="";this.match=""}var rules=this._currentRules();for(var i=0;i<rules.length;i++){tempMatch=this._input.match(this.rules[rules[i]]);if(tempMatch&&(!match||tempMatch[0].length>match[0].length)){match=tempMatch;index=i;if(!this.options.flex)break}}if(match){lines=match[0].match(/(?:\r\n?|\n).*/g);if(lines)this.yylineno+=lines.length;this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:lines?lines[lines.length-1].length-lines[lines.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+match[0].length};this.yytext+=match[0];this.match+=match[0];this.matches=match;this.yyleng=this.yytext.length;if(this.options.ranges){this.yylloc.range=[this.offset,this.offset+=this.yyleng]}this._more=false;this._input=this._input.slice(match[0].length);this.matched+=match[0];token=this.performAction.call(this,this.yy,this,rules[index],this.conditionStack[this.conditionStack.length-1]);if(this.done&&this._input)this.done=false;if(token)return token;else return}if(this._input===""){return this.EOF}else{return this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})}},lex:function lex(){var r=this.next();if(typeof r!=="undefined"){return r}else{return this.lex()}},begin:function begin(condition){this.conditionStack.push(condition)},popState:function popState(){return this.conditionStack.pop()},_currentRules:function _currentRules(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function begin(condition){this.begin(condition)}};lexer.options={};lexer.performAction=function anonymous(yy,yy_,$avoiding_name_collisions,YY_START){function strip(start,end){return yy_.yytext=yy_.yytext.substr(start,yy_.yyleng-end)
}var YYSTATE=YY_START;switch($avoiding_name_collisions){case 0:if(yy_.yytext.slice(-2)==="\\\\"){strip(0,1);this.begin("mu")}else if(yy_.yytext.slice(-1)==="\\"){strip(0,1);this.begin("emu")}else{this.begin("mu")}if(yy_.yytext)return 14;break;case 1:return 14;break;case 2:this.popState();return 14;break;case 3:strip(0,4);this.popState();return 15;break;case 4:return 35;break;case 5:return 36;break;case 6:return 25;break;case 7:return 16;break;case 8:return 20;break;case 9:return 19;break;case 10:return 19;break;case 11:return 23;break;case 12:return 22;break;case 13:this.popState();this.begin("com");break;case 14:strip(3,5);this.popState();return 15;break;case 15:return 22;break;case 16:return 41;break;case 17:return 40;break;case 18:return 40;break;case 19:return 44;break;case 20:break;case 21:this.popState();return 24;break;case 22:this.popState();return 18;break;case 23:yy_.yytext=strip(1,2).replace(/\\"/g,'"');return 32;break;case 24:yy_.yytext=strip(1,2).replace(/\\'/g,"'");return 32;break;case 25:return 42;break;case 26:return 34;break;case 27:return 34;break;case 28:return 33;break;case 29:return 40;break;case 30:yy_.yytext=strip(1,2);return 40;break;case 31:return"INVALID";break;case 32:return 5;break}};lexer.rules=[/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|\\\{\{|\\\\\{\{|$)))/,/^(?:[\s\S]*?--\}\})/,/^(?:\()/,/^(?:\))/,/^(?:\{\{(~)?>)/,/^(?:\{\{(~)?#)/,/^(?:\{\{(~)?\/)/,/^(?:\{\{(~)?\^)/,/^(?:\{\{(~)?\s*else\b)/,/^(?:\{\{(~)?\{)/,/^(?:\{\{(~)?&)/,/^(?:\{\{!--)/,/^(?:\{\{![\s\S]*?\}\})/,/^(?:\{\{(~)?)/,/^(?:=)/,/^(?:\.\.)/,/^(?:\.(?=([=~}\s\/.)])))/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}(~)?\}\})/,/^(?:(~)?\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@)/,/^(?:true(?=([~}\s)])))/,/^(?:false(?=([~}\s)])))/,/^(?:-?[0-9]+(?=([~}\s)])))/,/^(?:([^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=([=~}\s\/.)]))))/,/^(?:\[[^\]]*\])/,/^(?:.)/,/^(?:$)/];lexer.conditions={mu:{rules:[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32],inclusive:false},emu:{rules:[2],inclusive:false},com:{rules:[3],inclusive:false},INITIAL:{rules:[0,1,32],inclusive:true}};return lexer}();parser.lexer=lexer;function Parser(){this.yy={}}Parser.prototype=parser;parser.Parser=Parser;return new Parser}();__exports__=handlebars;return __exports__}();var __module8__=function(__dependency1__,__dependency2__){"use strict";var __exports__={};var parser=__dependency1__;var AST=__dependency2__;__exports__.parser=parser;function parse(input){if(input.constructor===AST.ProgramNode){return input}parser.yy=AST;return parser.parse(input)}__exports__.parse=parse;return __exports__}(__module9__,__module7__);var __module10__=function(__dependency1__){"use strict";var __exports__={};var Exception=__dependency1__;function Compiler(){}__exports__.Compiler=Compiler;Compiler.prototype={compiler:Compiler,disassemble:function(){var opcodes=this.opcodes,opcode,out=[],params,param;for(var i=0,l=opcodes.length;i<l;i++){opcode=opcodes[i];if(opcode.opcode==="DECLARE"){out.push("DECLARE "+opcode.name+"="+opcode.value)}else{params=[];for(var j=0;j<opcode.args.length;j++){param=opcode.args[j];if(typeof param==="string"){param='"'+param.replace("\n","\\n")+'"'}params.push(param)}out.push(opcode.opcode+" "+params.join(" "))}}return out.join("\n")},equals:function(other){var len=this.opcodes.length;if(other.opcodes.length!==len){return false}for(var i=0;i<len;i++){var opcode=this.opcodes[i],otherOpcode=other.opcodes[i];if(opcode.opcode!==otherOpcode.opcode||opcode.args.length!==otherOpcode.args.length){return false}for(var j=0;j<opcode.args.length;j++){if(opcode.args[j]!==otherOpcode.args[j]){return false}}}len=this.children.length;if(other.children.length!==len){return false}for(i=0;i<len;i++){if(!this.children[i].equals(other.children[i])){return false}}return true},guid:0,compile:function(program,options){this.opcodes=[];this.children=[];this.depths={list:[]};this.options=options;var knownHelpers=this.options.knownHelpers;this.options.knownHelpers={helperMissing:true,blockHelperMissing:true,each:true,"if":true,unless:true,"with":true,log:true};if(knownHelpers){for(var name in knownHelpers){this.options.knownHelpers[name]=knownHelpers[name]}}return this.accept(program)},accept:function(node){var strip=node.strip||{},ret;if(strip.left){this.opcode("strip")}ret=this[node.type](node);if(strip.right){this.opcode("strip")}return ret},program:function(program){var statements=program.statements;for(var i=0,l=statements.length;i<l;i++){this.accept(statements[i])}this.isSimple=l===1;this.depths.list=this.depths.list.sort(function(a,b){return a-b});return this},compileProgram:function(program){var result=(new this.compiler).compile(program,this.options);var guid=this.guid++,depth;this.usePartial=this.usePartial||result.usePartial;this.children[guid]=result;for(var i=0,l=result.depths.list.length;i<l;i++){depth=result.depths.list[i];if(depth<2){continue}else{this.addDepth(depth-1)}}return guid},block:function(block){var mustache=block.mustache,program=block.program,inverse=block.inverse;if(program){program=this.compileProgram(program)}if(inverse){inverse=this.compileProgram(inverse)}var sexpr=mustache.sexpr;var type=this.classifySexpr(sexpr);if(type==="helper"){this.helperSexpr(sexpr,program,inverse)}else if(type==="simple"){this.simpleSexpr(sexpr);this.opcode("pushProgram",program);this.opcode("pushProgram",inverse);this.opcode("emptyHash");this.opcode("blockValue")}else{this.ambiguousSexpr(sexpr,program,inverse);this.opcode("pushProgram",program);this.opcode("pushProgram",inverse);this.opcode("emptyHash");this.opcode("ambiguousBlockValue")}this.opcode("append")},hash:function(hash){var pairs=hash.pairs,pair,val;this.opcode("pushHash");for(var i=0,l=pairs.length;i<l;i++){pair=pairs[i];val=pair[1];if(this.options.stringParams){if(val.depth){this.addDepth(val.depth)}this.opcode("getContext",val.depth||0);this.opcode("pushStringParam",val.stringModeValue,val.type);if(val.type==="sexpr"){this.sexpr(val)}}else{this.accept(val)}this.opcode("assignToHash",pair[0])}this.opcode("popHash")},partial:function(partial){var partialName=partial.partialName;this.usePartial=true;if(partial.context){this.ID(partial.context)}else{this.opcode("push","depth0")}this.opcode("invokePartial",partialName.name);this.opcode("append")},content:function(content){this.opcode("appendContent",content.string)},mustache:function(mustache){this.sexpr(mustache.sexpr);if(mustache.escaped&&!this.options.noEscape){this.opcode("appendEscaped")}else{this.opcode("append")}},ambiguousSexpr:function(sexpr,program,inverse){var id=sexpr.id,name=id.parts[0],isBlock=program!=null||inverse!=null;this.opcode("getContext",id.depth);this.opcode("pushProgram",program);this.opcode("pushProgram",inverse);this.opcode("invokeAmbiguous",name,isBlock)},simpleSexpr:function(sexpr){var id=sexpr.id;if(id.type==="DATA"){this.DATA(id)}else if(id.parts.length){this.ID(id)}else{this.addDepth(id.depth);this.opcode("getContext",id.depth);this.opcode("pushContext")}this.opcode("resolvePossibleLambda")},helperSexpr:function(sexpr,program,inverse){var params=this.setupFullMustacheParams(sexpr,program,inverse),name=sexpr.id.parts[0];if(this.options.knownHelpers[name]){this.opcode("invokeKnownHelper",params.length,name)}else if(this.options.knownHelpersOnly){throw new Exception("You specified knownHelpersOnly, but used the unknown helper "+name,sexpr)}else{this.opcode("invokeHelper",params.length,name,sexpr.isRoot)}},sexpr:function(sexpr){var type=this.classifySexpr(sexpr);if(type==="simple"){this.simpleSexpr(sexpr)}else if(type==="helper"){this.helperSexpr(sexpr)}else{this.ambiguousSexpr(sexpr)}},ID:function(id){this.addDepth(id.depth);this.opcode("getContext",id.depth);var name=id.parts[0];if(!name){this.opcode("pushContext")}else{this.opcode("lookupOnContext",id.parts[0])}for(var i=1,l=id.parts.length;i<l;i++){this.opcode("lookup",id.parts[i])}},DATA:function(data){this.options.data=true;if(data.id.isScoped||data.id.depth){throw new Exception("Scoped data references are not supported: "+data.original,data)}this.opcode("lookupData");var parts=data.id.parts;for(var i=0,l=parts.length;i<l;i++){this.opcode("lookup",parts[i])}},STRING:function(string){this.opcode("pushString",string.string)},INTEGER:function(integer){this.opcode("pushLiteral",integer.integer)},BOOLEAN:function(bool){this.opcode("pushLiteral",bool.bool)},comment:function(){},opcode:function(name){this.opcodes.push({opcode:name,args:[].slice.call(arguments,1)})},declare:function(name,value){this.opcodes.push({opcode:"DECLARE",name:name,value:value})},addDepth:function(depth){if(depth===0){return}if(!this.depths[depth]){this.depths[depth]=true;this.depths.list.push(depth)}},classifySexpr:function(sexpr){var isHelper=sexpr.isHelper;var isEligible=sexpr.eligibleHelper;var options=this.options;if(isEligible&&!isHelper){var name=sexpr.id.parts[0];if(options.knownHelpers[name]){isHelper=true}else if(options.knownHelpersOnly){isEligible=false}}if(isHelper){return"helper"}else if(isEligible){return"ambiguous"}else{return"simple"}},pushParams:function(params){var i=params.length,param;while(i--){param=params[i];if(this.options.stringParams){if(param.depth){this.addDepth(param.depth)}this.opcode("getContext",param.depth||0);this.opcode("pushStringParam",param.stringModeValue,param.type);if(param.type==="sexpr"){this.sexpr(param)}}else{this[param.type](param)}}},setupFullMustacheParams:function(sexpr,program,inverse){var params=sexpr.params;this.pushParams(params);this.opcode("pushProgram",program);this.opcode("pushProgram",inverse);if(sexpr.hash){this.hash(sexpr.hash)}else{this.opcode("emptyHash")}return params}};function precompile(input,options,env){if(input==null||typeof input!=="string"&&input.constructor!==env.AST.ProgramNode){throw new Exception("You must pass a string or Handlebars AST to Handlebars.precompile. You passed "+input)}options=options||{};if(!("data"in options)){options.data=true}var ast=env.parse(input);var environment=(new env.Compiler).compile(ast,options);return(new env.JavaScriptCompiler).compile(environment,options)}__exports__.precompile=precompile;function compile(input,options,env){if(input==null||typeof input!=="string"&&input.constructor!==env.AST.ProgramNode){throw new Exception("You must pass a string or Handlebars AST to Handlebars.compile. You passed "+input)}options=options||{};if(!("data"in options)){options.data=true}var compiled;function compileInput(){var ast=env.parse(input);var environment=(new env.Compiler).compile(ast,options);var templateSpec=(new env.JavaScriptCompiler).compile(environment,options,undefined,true);return env.template(templateSpec)}return function(context,options){if(!compiled){compiled=compileInput()}return compiled.call(this,context,options)}}__exports__.compile=compile;return __exports__}(__module5__);var __module11__=function(__dependency1__,__dependency2__){"use strict";var __exports__;var COMPILER_REVISION=__dependency1__.COMPILER_REVISION;var REVISION_CHANGES=__dependency1__.REVISION_CHANGES;var log=__dependency1__.log;var Exception=__dependency2__;function Literal(value){this.value=value}function JavaScriptCompiler(){}JavaScriptCompiler.prototype={nameLookup:function(parent,name){var wrap,ret;if(parent.indexOf("depth")===0){wrap=true}if(/^[0-9]+$/.test(name)){ret=parent+"["+name+"]"}else if(JavaScriptCompiler.isValidJavaScriptVariableName(name)){ret=parent+"."+name}else{ret=parent+"['"+name+"']"}if(wrap){return"("+parent+" && "+ret+")"}else{return ret}},compilerInfo:function(){var revision=COMPILER_REVISION,versions=REVISION_CHANGES[revision];return"this.compilerInfo = ["+revision+",'"+versions+"'];\n"},appendToBuffer:function(string){if(this.environment.isSimple){return"return "+string+";"}else{return{appendToBuffer:true,content:string,toString:function(){return"buffer += "+string+";"}}}},initializeBuffer:function(){return this.quotedString("")},namespace:"Handlebars",compile:function(environment,options,context,asObject){this.environment=environment;this.options=options||{};log("debug",this.environment.disassemble()+"\n\n");this.name=this.environment.name;this.isChild=!!context;this.context=context||{programs:[],environments:[],aliases:{}};this.preamble();this.stackSlot=0;this.stackVars=[];this.registers={list:[]};this.hashes=[];this.compileStack=[];this.inlineStack=[];this.compileChildren(environment,options);var opcodes=environment.opcodes,opcode;this.i=0;for(var l=opcodes.length;this.i<l;this.i++){opcode=opcodes[this.i];if(opcode.opcode==="DECLARE"){this[opcode.name]=opcode.value}else{this[opcode.opcode].apply(this,opcode.args)}if(opcode.opcode!==this.stripNext){this.stripNext=false}}this.pushSource("");if(this.stackSlot||this.inlineStack.length||this.compileStack.length){throw new Exception("Compile completed with content left on stack")}return this.createFunctionContext(asObject)},preamble:function(){var out=[];if(!this.isChild){var namespace=this.namespace;var copies="helpers = this.merge(helpers, "+namespace+".helpers);";if(this.environment.usePartial){copies=copies+" partials = this.merge(partials, "+namespace+".partials);"}if(this.options.data){copies=copies+" data = data || {};"}out.push(copies)}else{out.push("")}if(!this.environment.isSimple){out.push(", buffer = "+this.initializeBuffer())}else{out.push("")}this.lastContext=0;this.source=out},createFunctionContext:function(asObject){var locals=this.stackVars.concat(this.registers.list);if(locals.length>0){this.source[1]=this.source[1]+", "+locals.join(", ")}if(!this.isChild){for(var alias in this.context.aliases){if(this.context.aliases.hasOwnProperty(alias)){this.source[1]=this.source[1]+", "+alias+"="+this.context.aliases[alias]}}}if(this.source[1]){this.source[1]="var "+this.source[1].substring(2)+";"}if(!this.isChild){this.source[1]+="\n"+this.context.programs.join("\n")+"\n"}if(!this.environment.isSimple){this.pushSource("return buffer;")}var params=this.isChild?["depth0","data"]:["Handlebars","depth0","helpers","partials","data"];for(var i=0,l=this.environment.depths.list.length;i<l;i++){params.push("depth"+this.environment.depths.list[i])}var source=this.mergeSource();if(!this.isChild){source=this.compilerInfo()+source}if(asObject){params.push(source);return Function.apply(this,params)}else{var functionSource="function "+(this.name||"")+"("+params.join(",")+") {\n  "+source+"}";log("debug",functionSource+"\n\n");return functionSource}},mergeSource:function(){var source="",buffer;for(var i=0,len=this.source.length;i<len;i++){var line=this.source[i];if(line.appendToBuffer){if(buffer){buffer=buffer+"\n    + "+line.content}else{buffer=line.content}}else{if(buffer){source+="buffer += "+buffer+";\n  ";buffer=undefined}source+=line+"\n  "}}return source},blockValue:function(){this.context.aliases.blockHelperMissing="helpers.blockHelperMissing";var params=["depth0"];this.setupParams(0,params);this.replaceStack(function(current){params.splice(1,0,current);return"blockHelperMissing.call("+params.join(", ")+")"})},ambiguousBlockValue:function(){this.context.aliases.blockHelperMissing="helpers.blockHelperMissing";var params=["depth0"];this.setupParams(0,params);var current=this.topStack();params.splice(1,0,current);this.pushSource("if (!"+this.lastHelper+") { "+current+" = blockHelperMissing.call("+params.join(", ")+"); }")},appendContent:function(content){if(this.pendingContent){content=this.pendingContent+content}if(this.stripNext){content=content.replace(/^\s+/,"")}this.pendingContent=content},strip:function(){if(this.pendingContent){this.pendingContent=this.pendingContent.replace(/\s+$/,"")}this.stripNext="strip"},append:function(){this.flushInline();var local=this.popStack();this.pushSource("if("+local+" || "+local+" === 0) { "+this.appendToBuffer(local)+" }");if(this.environment.isSimple){this.pushSource("else { "+this.appendToBuffer("''")+" }")}},appendEscaped:function(){this.context.aliases.escapeExpression="this.escapeExpression";this.pushSource(this.appendToBuffer("escapeExpression("+this.popStack()+")"))},getContext:function(depth){if(this.lastContext!==depth){this.lastContext=depth}},lookupOnContext:function(name){this.push(this.nameLookup("depth"+this.lastContext,name,"context"))},pushContext:function(){this.pushStackLiteral("depth"+this.lastContext)},resolvePossibleLambda:function(){this.context.aliases.functionType='"function"';this.replaceStack(function(current){return"typeof "+current+" === functionType ? "+current+".apply(depth0) : "+current})},lookup:function(name){this.replaceStack(function(current){return current+" == null || "+current+" === false ? "+current+" : "+this.nameLookup(current,name,"context")})},lookupData:function(){this.pushStackLiteral("data")},pushStringParam:function(string,type){this.pushStackLiteral("depth"+this.lastContext);this.pushString(type);if(type!=="sexpr"){if(typeof string==="string"){this.pushString(string)}else{this.pushStackLiteral(string)}}},emptyHash:function(){this.pushStackLiteral("{}");if(this.options.stringParams){this.push("{}");this.push("{}")}},pushHash:function(){if(this.hash){this.hashes.push(this.hash)}this.hash={values:[],types:[],contexts:[]}},popHash:function(){var hash=this.hash;this.hash=this.hashes.pop();if(this.options.stringParams){this.push("{"+hash.contexts.join(",")+"}");this.push("{"+hash.types.join(",")+"}")}this.push("{\n    "+hash.values.join(",\n    ")+"\n  }")},pushString:function(string){this.pushStackLiteral(this.quotedString(string))},push:function(expr){this.inlineStack.push(expr);return expr},pushLiteral:function(value){this.pushStackLiteral(value)},pushProgram:function(guid){if(guid!=null){this.pushStackLiteral(this.programExpression(guid))}else{this.pushStackLiteral(null)}},invokeHelper:function(paramSize,name,isRoot){this.context.aliases.helperMissing="helpers.helperMissing";this.useRegister("helper");var helper=this.lastHelper=this.setupHelper(paramSize,name,true);var nonHelper=this.nameLookup("depth"+this.lastContext,name,"context");var lookup="helper = "+helper.name+" || "+nonHelper;if(helper.paramsInit){lookup+=","+helper.paramsInit}this.push("("+lookup+",helper "+"? helper.call("+helper.callParams+") "+": helperMissing.call("+helper.helperMissingParams+"))");if(!isRoot){this.flushInline()}},invokeKnownHelper:function(paramSize,name){var helper=this.setupHelper(paramSize,name);this.push(helper.name+".call("+helper.callParams+")")},invokeAmbiguous:function(name,helperCall){this.context.aliases.functionType='"function"';this.useRegister("helper");this.emptyHash();var helper=this.setupHelper(0,name,helperCall);var helperName=this.lastHelper=this.nameLookup("helpers",name,"helper");var nonHelper=this.nameLookup("depth"+this.lastContext,name,"context");var nextStack=this.nextStack();if(helper.paramsInit){this.pushSource(helper.paramsInit)}this.pushSource("if (helper = "+helperName+") { "+nextStack+" = helper.call("+helper.callParams+"); }");this.pushSource("else { helper = "+nonHelper+"; "+nextStack+" = typeof helper === functionType ? helper.call("+helper.callParams+") : helper; }")},invokePartial:function(name){var params=[this.nameLookup("partials",name,"partial"),"'"+name+"'",this.popStack(),"helpers","partials"];if(this.options.data){params.push("data")}this.context.aliases.self="this";this.push("self.invokePartial("+params.join(", ")+")")},assignToHash:function(key){var value=this.popStack(),context,type;if(this.options.stringParams){type=this.popStack();context=this.popStack()}var hash=this.hash;if(context){hash.contexts.push("'"+key+"': "+context)}if(type){hash.types.push("'"+key+"': "+type)}hash.values.push("'"+key+"': ("+value+")")},compiler:JavaScriptCompiler,compileChildren:function(environment,options){var children=environment.children,child,compiler;for(var i=0,l=children.length;i<l;i++){child=children[i];compiler=new this.compiler;var index=this.matchExistingProgram(child);if(index==null){this.context.programs.push("");index=this.context.programs.length;child.index=index;child.name="program"+index;this.context.programs[index]=compiler.compile(child,options,this.context);this.context.environments[index]=child}else{child.index=index;child.name="program"+index}}},matchExistingProgram:function(child){for(var i=0,len=this.context.environments.length;i<len;i++){var environment=this.context.environments[i];if(environment&&environment.equals(child)){return i}}},programExpression:function(guid){this.context.aliases.self="this";if(guid==null){return"self.noop"}var child=this.environment.children[guid],depths=child.depths.list,depth;var programParams=[child.index,child.name,"data"];for(var i=0,l=depths.length;i<l;i++){depth=depths[i];if(depth===1){programParams.push("depth0")}else{programParams.push("depth"+(depth-1))}}return(depths.length===0?"self.program(":"self.programWithDepth(")+programParams.join(", ")+")"},register:function(name,val){this.useRegister(name);this.pushSource(name+" = "+val+";")},useRegister:function(name){if(!this.registers[name]){this.registers[name]=true;this.registers.list.push(name)}},pushStackLiteral:function(item){return this.push(new Literal(item))},pushSource:function(source){if(this.pendingContent){this.source.push(this.appendToBuffer(this.quotedString(this.pendingContent)));this.pendingContent=undefined}if(source){this.source.push(source)}},pushStack:function(item){this.flushInline();var stack=this.incrStack();if(item){this.pushSource(stack+" = "+item+";")}this.compileStack.push(stack);return stack},replaceStack:function(callback){var prefix="",inline=this.isInline(),stack,createdStack,usedLiteral;if(inline){var top=this.popStack(true);if(top instanceof Literal){stack=top.value;usedLiteral=true}else{createdStack=!this.stackSlot;var name=!createdStack?this.topStackName():this.incrStack();prefix="("+this.push(name)+" = "+top+"),";stack=this.topStack()}}else{stack=this.topStack()}var item=callback.call(this,stack);if(inline){if(!usedLiteral){this.popStack()}if(createdStack){this.stackSlot--}this.push("("+prefix+item+")")}else{if(!/^stack/.test(stack)){stack=this.nextStack()}this.pushSource(stack+" = ("+prefix+item+");")}return stack},nextStack:function(){return this.pushStack()},incrStack:function(){this.stackSlot++;if(this.stackSlot>this.stackVars.length){this.stackVars.push("stack"+this.stackSlot)}return this.topStackName()},topStackName:function(){return"stack"+this.stackSlot},flushInline:function(){var inlineStack=this.inlineStack;if(inlineStack.length){this.inlineStack=[];for(var i=0,len=inlineStack.length;i<len;i++){var entry=inlineStack[i];if(entry instanceof Literal){this.compileStack.push(entry)}else{this.pushStack(entry)}}}},isInline:function(){return this.inlineStack.length},popStack:function(wrapped){var inline=this.isInline(),item=(inline?this.inlineStack:this.compileStack).pop();if(!wrapped&&item instanceof Literal){return item.value}else{if(!inline){if(!this.stackSlot){throw new Exception("Invalid stack pop")}this.stackSlot--}return item}},topStack:function(wrapped){var stack=this.isInline()?this.inlineStack:this.compileStack,item=stack[stack.length-1];if(!wrapped&&item instanceof Literal){return item.value}else{return item}},quotedString:function(str){return'"'+str.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")+'"'},setupHelper:function(paramSize,name,missingParams){var params=[],paramsInit=this.setupParams(paramSize,params,missingParams);var foundHelper=this.nameLookup("helpers",name,"helper");return{params:params,paramsInit:paramsInit,name:foundHelper,callParams:["depth0"].concat(params).join(", "),helperMissingParams:missingParams&&["depth0",this.quotedString(name)].concat(params).join(", ")}},setupOptions:function(paramSize,params){var options=[],contexts=[],types=[],param,inverse,program;options.push("hash:"+this.popStack());if(this.options.stringParams){options.push("hashTypes:"+this.popStack());options.push("hashContexts:"+this.popStack())}inverse=this.popStack();program=this.popStack();if(program||inverse){if(!program){this.context.aliases.self="this";program="self.noop"}if(!inverse){this.context.aliases.self="this";inverse="self.noop"}options.push("inverse:"+inverse);options.push("fn:"+program)}for(var i=0;i<paramSize;i++){param=this.popStack();params.push(param);if(this.options.stringParams){types.push(this.popStack());contexts.push(this.popStack())}}if(this.options.stringParams){options.push("contexts:["+contexts.join(",")+"]");options.push("types:["+types.join(",")+"]")}if(this.options.data){options.push("data:data")}return options},setupParams:function(paramSize,params,useRegister){var options="{"+this.setupOptions(paramSize,params).join(",")+"}";if(useRegister){this.useRegister("options");params.push("options");return"options="+options}else{params.push(options);return""}}};var reservedWords=("break else new var"+" case finally return void"+" catch for switch while"+" continue function this with"+" default if throw"+" delete in try"+" do instanceof typeof"+" abstract enum int short"+" boolean export interface static"+" byte extends long super"+" char final native synchronized"+" class float package throws"+" const goto private transient"+" debugger implements protected volatile"+" double import public let yield").split(" ");var compilerWords=JavaScriptCompiler.RESERVED_WORDS={};for(var i=0,l=reservedWords.length;i<l;i++){compilerWords[reservedWords[i]]=true}JavaScriptCompiler.isValidJavaScriptVariableName=function(name){if(!JavaScriptCompiler.RESERVED_WORDS[name]&&/^[a-zA-Z_$][0-9a-zA-Z_$]*$/.test(name)){return true}return false};__exports__=JavaScriptCompiler;return __exports__}(__module2__,__module5__);var __module0__=function(__dependency1__,__dependency2__,__dependency3__,__dependency4__,__dependency5__){"use strict";var __exports__;var Handlebars=__dependency1__;var AST=__dependency2__;var Parser=__dependency3__.parser;var parse=__dependency3__.parse;var Compiler=__dependency4__.Compiler;var compile=__dependency4__.compile;var precompile=__dependency4__.precompile;var JavaScriptCompiler=__dependency5__;var _create=Handlebars.create;var create=function(){var hb=_create();hb.compile=function(input,options){return compile(input,options,hb)};hb.precompile=function(input,options){return precompile(input,options,hb)};hb.AST=AST;hb.Compiler=Compiler;hb.JavaScriptCompiler=JavaScriptCompiler;hb.Parser=Parser;hb.parse=parse;return hb};Handlebars=create();Handlebars.create=create;__exports__=Handlebars;return __exports__}(__module1__,__module7__,__module8__,__module10__,__module11__);return __module0__}();browserify_shim__define__module__export__(typeof Handlebars!="undefined"?Handlebars:window.Handlebars)}).call(global,undefined,undefined,undefined,undefined,function defineExport(ex){module.exports=ex})}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],10:[function(require,module,exports){(function(global){var __browserify_shim_require__=require;(function browserifyShim(module,exports,require,define,browserify_shim__define__module__export__){(function(root,factory){if(typeof define==="function"&&define.amd){define(function(){return factory(root)})}else if(typeof exports==="object"){module.exports=factory}else{root.echo=factory(root)}})(this,function(root){"use strict";var echo={};var callback=function(){};var offset,poll,delay,useDebounce,unload;var inView=function(element,view){var box=element.getBoundingClientRect();return box.right>=view.l&&box.bottom>=view.t&&box.left<=view.r&&box.top<=view.b};var debounceOrThrottle=function(){if(!useDebounce&&!!poll){return}clearTimeout(poll);poll=setTimeout(function(){echo.render();poll=null},delay)};echo.init=function(opts){opts=opts||{};var offsetAll=opts.offset||0;var offsetVertical=opts.offsetVertical||offsetAll;var offsetHorizontal=opts.offsetHorizontal||offsetAll;var optionToInt=function(opt,fallback){return parseInt(opt||fallback,10)};offset={t:optionToInt(opts.offsetTop,offsetVertical),b:optionToInt(opts.offsetBottom,offsetVertical),l:optionToInt(opts.offsetLeft,offsetHorizontal),r:optionToInt(opts.offsetRight,offsetHorizontal)};delay=optionToInt(opts.throttle,250);useDebounce=opts.debounce!==false;unload=!!opts.unload;callback=opts.callback||callback;echo.render();if(document.addEventListener){root.addEventListener("scroll",debounceOrThrottle,false);root.addEventListener("load",debounceOrThrottle,false)}else{root.attachEvent("onscroll",debounceOrThrottle);root.attachEvent("onload",debounceOrThrottle)}};echo.render=function(){var nodes=document.querySelectorAll("img[data-echo]");var length=nodes.length;var src,elem;var view={l:0-offset.l,t:0-offset.t,b:(root.innerHeight||document.documentElement.clientHeight)+offset.b,r:(root.innerWidth||document.documentElement.clientWidth)+offset.r};function updateThumb(s3Path,elemID){jQuery.get("/stable/get_thumbnail?path="+s3Path,function(data){$(elemID).attr("src",data)})}for(var i=0;i<length;i++){elem=nodes[i];if(inView(elem,view)){if(unload){elem.setAttribute("data-echo-placeholder",elem.src)}var s3Path=elem.getAttribute("data-echo");var elemID="#"+elem.id;updateThumb(s3Path,elemID);if(!unload){elem.removeAttribute("data-echo")}callback(elem,"load")}else if(unload&&!!(src=elem.getAttribute("data-echo-placeholder"))){elem.src=src;elem.removeAttribute("data-echo-placeholder");callback(elem,"unload")}}if(!length){echo.detach()}};echo.detach=function(){if(document.removeEventListener){root.removeEventListener("scroll",debounceOrThrottle)}else{root.detachEvent("onscroll",debounceOrThrottle)}clearTimeout(poll)};return echo});browserify_shim__define__module__export__(typeof thumbsecho!="undefined"?thumbsecho:window.thumbsecho)}).call(global,undefined,undefined,undefined,undefined,function defineExport(ex){module.exports=ex})}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],11:[function(require,module,exports){module.exports={settings:{institution_consortium_map:{},database_level_data:{title:"JSTOR",datatype:"DATABASE",publisher:""},pamphlet_level_data:{title:"PAMPHLETS",datatype:"DATABASE",itemtype:"RECORD_VIEW"},pamphlet_search_click_data:{title:"PAMPHLETS",datatype:"DATABASE",itemtype:"RESULT_CLICK"},search_fed_data:{title:"JSTOR",datatype:"DATABASE",itemtype:"SEARCH_FED",publisher:""},page_scan_tab_hash:"#page_scan_tab_contents",references_tab_hash:"#references_tab_contents",full_text_tab_hash:"#full_text_tab_contents",pdf_only_tab_hash:"#pdf_only_tab_contents",has_access:undefined,is_page_scan:false,is_pdf_only:false,is_full_text:false},set_journal_level_data:function(data){this.settings.journal_level_data={datatype:"JOURNAL",title:data.journal};return this},set_article_level_data:function(data){this.settings.article_level_data={yop:data.yop,doi:data.doi,title:data.title,datatype:"JOURNAL_ARTICLE"};return this},push_pamphlet_data:function(url){var event_list=[];if(url&&typeof url==="string"){if(!this.settings.has_access){this.settings.pamphlet_level_data.itemtype="NO_LICENSE"}event_list=[this.settings.pamphlet_level_data];if(url.indexOf("resultItemClick")!==-1){event_list.push(this.settings.pamphlet_search_click_data)}}return event_list},push_journal_data:function(itemtype){if(this.settings.has_access){return[$.extend({itemtype:itemtype},this.settings.journal_level_data),$.extend({itemtype:itemtype},this.settings.article_level_data)]}else{return[$.extend({itemtype:itemtype},this.settings.journal_level_data),$.extend({itemtype:itemtype},this.settings.database_level_data)]}},push_result_click_event:function(url,event_list){if(url.indexOf("resultItemClick")!==-1){var result_click_event={itemtype:"RESULT_CLICK"};$.extend(result_click_event,this.settings.database_level_data);event_list.push(result_click_event)}return event_list},send_article_events:function(url,has_abstract){if(this.settings.is_page_scan){this.send_page_scan_events(url)}else if(this.settings.is_pdf_only){this.send_pdf_only_events(url,has_abstract)}else if(this.settings.is_full_text){this.send_full_text_events(url,has_abstract)
}},send_page_scan_events:function(url){var event_list=[];if(this.settings.content_type==="pamphlet"){event_list=this.push_pamphlet_data(url)}else{event_list=this.push_page_scan_events(url)}this.send_events(event_list)},push_page_scan_events:function(url){var event_list=[],data_type="FT_HTML";if(!this.settings.has_access&&this.settings.institution_consortium_map.length){data_type="NO_LICENSE"}event_list=this.push_journal_data(data_type);event_list=this.push_result_click_event(url,event_list);return event_list},send_pdf_only_events:function(url,has_abstract){var event_list=[];event_list=this.push_pdf_only_events(!this.settings.has_access&&this.settings.institution_consortium_map.length,has_abstract);event_list=this.push_result_click_event(url,event_list);this.send_events(event_list)},push_pdf_only_events:function(is_no_license,has_abstract){var pdf_only_events=[];if(is_no_license){pdf_only_events=[$.extend({itemtype:"NO_LICENSE"},this.settings.journal_level_data),$.extend({itemtype:"NO_LICENSE"},this.settings.database_level_data)]}else{pdf_only_events=[$.extend({itemtype:"RECORD_VIEW"},this.settings.journal_level_data),$.extend({itemtype:"RECORD_VIEW"},this.settings.database_level_data)];if(has_abstract){pdf_only_events.push($.extend({itemtype:"ABSTRACT"},this.settings.journal_level_data))}}return pdf_only_events},send_full_text_events:function(url,has_abstract){var event_list=[];event_list=this.push_full_text_events(!this.settings.has_access&&this.settings.institution_consortium_map.length,has_abstract);event_list=this.push_result_click_event(url,event_list);this.send_events(event_list)},push_full_text_events:function(is_no_license,has_abstract){var full_text_events=[];if(is_no_license){full_text_events=[$.extend({itemtype:"NO_LICENSE"},this.settings.journal_level_data),$.extend({itemtype:"NO_LICENSE"},this.settings.database_level_data)]}else{full_text_events=[$.extend({itemtype:"FT_HTML"},this.settings.journal_level_data),$.extend({itemtype:"FT_HTML"},this.settings.article_level_data)];if(has_abstract){full_text_events.push($.extend({itemtype:"ABSTRACT"},this.settings.journal_level_data))}}return full_text_events},push_journal_data_to_summary_events:function(){return[$.extend({itemtype:"ABSTRACT"},this.settings.journal_level_data),$.extend({itemtype:"RECORD_VIEW"},this.settings.journal_level_data),$.extend({itemtype:"RECORD_VIEW"},this.settings.database_level_data)]},push_reference_data_events:function(){return[$.extend({itemtype:"RECORD_VIEW"},this.settings.journal_level_data),$.extend({itemtype:"RECORD_VIEW"},this.settings.database_level_data)]},send_summary_events:function(){var event_list=[];if(this.settings.content_type==="pamphlet"){return this.send_events([this.settings.pamphlet_level_data])}else{if(this.settings.is_page_scan){return this.send_events(this.push_journal_data_to_summary_events())}else if(this.settings.is_full_text){return this.send_events(this.push_reference_data_events())}return this.send_events([])}},send_search_fed_event:function(){this.send_events([this.settings.search_fed_data])},send_events:function(eventList){var the_event=null;if(!this.settings.institution_consortium_map.length){for(var event in eventList){the_event=eventList[event];if(the_event){eventList[event].customerid="UNAFFILIATED"}window._$tarQ.push(["track",the_event])}}else{var event_to_push=null;var first_consortium=true;$.each(this.settings.institution_consortium_map,function(index,customerid){if(typeof customerid==="string"){for(var event_consort in eventList){event_to_push=$.extend(true,{},eventList[event_consort]);if(event_to_push){event_to_push.customerid=customerid}window._$tarQ.push(["track",event_to_push])}}else if(typeof customerid==="object"){if(!first_consortium&&customerid[1].indexOf("+")<0){customerid[1]="+"+customerid[1]}first_consortium=false;for(var consort_event in eventList){event_to_push=$.extend(true,{},eventList[consort_event]);if(event_to_push){event_to_push.customerid=customerid[0];event_to_push.consortium=customerid[1]}window._$tarQ.push(["track",event_to_push])}}event_to_push=null})}},init:function(starData,url,hash,has_abstract){var self=this;this.settings.content_type=starData.contentType;this.settings.institution_consortium_map=starData.institution_consortium_map;this.settings.has_access=starData.has_access;this.settings.is_page_scan=starData.page_scan;this.settings.is_pdf_only=starData.pdf_only;this.settings.is_full_text=starData.full_text;if(starData.SEARCH_FED==="True"){this.send_search_fed_event()}this.set_journal_level_data(starData).set_article_level_data(starData);if(hash===this.settings.references_tab_hash){this.send_summary_events()}if(this.settings.has_access||this.settings.institution_consortium_map.length){if(hash===this.settings.page_scan_tab_hash||hash===this.settings.full_text_tab_hash||hash===this.settings.pdf_only_tab_hash||hash===""){this.send_article_events(url,has_abstract)}}$("#page_scan_tab").on("click",function(){self.send_article_events(url,has_abstract)});$("#references_tab").on("click",function(){self.send_summary_events()})}}},{}],12:[function(require,module,exports){var Handlebars=require("handlebars");module.exports={settings:{url_parameters:{save:"saveCitation=true",track:"trackCitation=true",e_toc:"eToc=true"},overlay:{title:{save:"Citations Saved",track:"Citation Alerts Created",e_toc:"Journal Alert Created"},success_message:{save:"Your citations have been saved.",track:"Your citations are now being tracked. You will receive an email alert when these items are cited.",e_toc:"Your journal alert has been created. You will receive an email alert when a new issue is released."}},foundation_reveal:{animation:"none",animationSpeed:0,bg_class:"none"}},accepted_citation_type:function(citation_type){if(citation_type&&(citation_type==="track"||citation_type==="save"||citation_type==="e_toc")){return true}return false},get_overlay_success_message:function(citation_type){if(this.accepted_citation_type(citation_type)){return this.settings.overlay.success_message[citation_type]}return false},get_overlay_title:function(citation_type){if(this.accepted_citation_type(citation_type)){return this.settings.overlay.title[citation_type]}return false},get_overlay_parameters:function(citation,citation_type,overlay_title,overlay_success_message){var overlay_parameters={overlayTitle:overlay_title,overlaySuccess:overlay_success_message,citationItems:[citation]};if(citation_type!=="e_toc"){overlay_parameters.totalItems=1}return overlay_parameters},citation_type:function(url){if(url){if(url.search(this.settings.url_parameters.save)!==-1){return"save"}if(url.search(this.settings.url_parameters.track)!==-1){return"track"}if(url.search(this.settings.url_parameters.e_toc)!==-1){return"e_toc"}}return false},launch_overlay:function(tpl,citation,citation_type){if(tpl&&citation_type&&citation&&citation.id&&citation.title){var overlay=Handlebars.compile(tpl.html()),overlay_title=this.get_overlay_title(citation_type),overlay_success_message=this.get_overlay_success_message(citation_type),overlay_parameters=this.get_overlay_parameters(citation,citation_type,overlay_title,overlay_success_message);if(overlay&&overlay_title&&overlay_success_message&&overlay_parameters){$.ajax({url:"/action/emailCitations",cache:false});$("body").append(overlay(overlay_parameters));$("#saveCitationOverlay").foundation("reveal",this.settings.foundation_reveal).foundation("reveal","open");return true}}return false},init:function(url,citation){var citation_type=this.citation_type(url),overlay_tpl=$("#tpl-saveTrackCitation");if(citation_type&&overlay_tpl.length){return this.launch_overlay(overlay_tpl,citation,citation_type)}return false}}},{handlebars:9}],13:[function(require,module,exports){(function(global){var Clipboard=require("shared/vendor/clipboard.min");typeof window!=="undefined"?window["jslogger"]:typeof global!=="undefined"?global["jslogger"]:null;require("foundation5/foundation.tooltip");module.exports={current_element:{area_label:""},activate:function(element){var clipboard=new Clipboard(element),self=this;Foundation.libs.tooltip.settings.tip_template=function(selector,content){return'<span id="'+selector+'" data-selector="'+selector+'" class="'+Foundation.libs.tooltip.settings.tooltip_class.substring(1)+'"><span class="content" data-content="'+content+'">'+content+'</span><span class="nub"></span></span>'};clipboard.on("success",function(event){var copied_id=$(event.trigger).data("selector");$("button.paste").removeClass("paste").addClass("copy");$(event.trigger).removeClass("copy").addClass("paste").attr("aria-label","Copied!");$("#"+copied_id+" .content").text("Copied!");jslogger.log_event("info","copy_to_clipboard.success",{javascript:"Copy to clipboard successful",event_data:{action:event.action+" of "+$(event.trigger).data("tracking").toLowerCase()+" successful",text:event.text}});self.track_usage($(event.trigger))});clipboard.on("error",function(event){var copied_id=$(event.trigger).data("selector");$("button.paste").removeClass("paste").addClass("copy");$("#"+copied_id+" .content").text("Press Ctrl+C to copy!");self.track_usage($(event.trigger));jslogger.log_event("error","copy_to_clipboard.unable_to_copy_to_clipboard",{javascript:"Unable to copy to clipboard, falling back to keyboard message",event_data:{action:event.action,trigger:$(event.trigger).data("tracking").toLowerCase()}})});Foundation.libs.tooltip.create($(element));$(element).hover(function(){var hovered_id=$(this).data("selector"),tip_text=$("#"+hovered_id+" .content").data("content");self.current_element.area_label=$(this).attr("aria-label");$("#"+hovered_id+" .content").text(tip_text);Foundation.libs.tooltip.show($(this))},function(){Foundation.libs.tooltip.hide($(this));$(this).attr("aria-label",self.current_element.area_label);self.current_element.area_label=""})},track_usage:function($triggered_element){if(typeof _satellite!=="undefined"&&$triggered_element.data("tracking")){_satellite.track($triggered_element.data("tracking").toLowerCase())}},deactivate:function(){$("span[id^='clipboard-tip']").remove()}}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"foundation5/foundation.tooltip":6,"shared/vendor/clipboard.min":8}],14:[function(require,module,exports){module.exports=function(querystring,variable){if(!querystring||!variable){return false}var query=querystring.substring(1),vars=query.split("&"),pair;for(var i=0;i<vars.length;i++){pair=vars[i].split("=");if(pair[0]===variable){return pair[1]}}return false}},{}],15:[function(require,module,exports){(function(global){typeof window!=="undefined"?window["jslogger"]:typeof global!=="undefined"?global["jslogger"]:null;var replace_url_param=require("shared/views/components/replace-url-param"),get_query_param=require("shared/views/components/get-query-param"),search_term_highlighting=require("shared/views/components/term-highlighting"),$page_scan_container=$(".page-scan-container"),pagescan={vars:{$page_range:$(".page-scan-current-page"),$page_scan_container:$page_scan_container,page_scan_alt:$page_scan_container.attr("alt"),current_page_number:1,page_count:parseInt($page_scan_container.attr("data-last"),10),$element_to_scroll_to_when_navigating:$("[id$='_view_content']"),$scan_image_wrapper:$(".scan-image-wrapper"),$image_container:$page_scan_container},init:function(){var self=this;if($("#page_scan_tab").hasClass("active")){this.apply_page_setup()}else{if(!$("#full_text_tab_contents, #pdf_only_tab_contents").length){$(window).on("hashchange",function(){self.apply_page_setup()})}}},apply_page_setup:function(){if($("#page_scan_tab").hasClass("active")){this.vars.current_page_number=this.get_page_number(window.location.search,"seq");var $current_page=$("#page"+this.vars.current_page_number);this.apply_page_control_state();this.retrieve_image($current_page.attr("data-doi"),$current_page.attr("data-s3"),this.vars.current_page_number,$current_page.attr("data-pagename"),$current_page.attr("data-page"));$(".previous-page").on("click",this.deliver_previous_page.bind(this));$(".next-page").on("click",this.deliver_next_page.bind(this));$(".search-term-list-link").on("click",this.deliver_specific_page.bind(this))}},deliver_specific_page:function(e){e.preventDefault();var requested_page_number=$(e.currentTarget).data("seq"),$requested_page=$("#page"+requested_page_number);if(this.vars.current_page_number!==requested_page_number&&$requested_page.length){this.retrieve_image($requested_page.data("doi"),$requested_page.data("s3"),requested_page_number,$requested_page.data("pagename"));this.scroll_to_top()}$(".close").click();this.apply_page_control_state()},deliver_previous_page:function(e){e.preventDefault();if(this.vars.current_page_number>1){var previous_page_number=this.vars.current_page_number-1,$previous_page=$("#page"+previous_page_number);this.retrieve_image($previous_page.attr("data-doi"),$previous_page.attr("data-s3"),previous_page_number,$previous_page.attr("data-pagename"),$previous_page.attr("data-page"));this.scroll_to_top()}this.apply_page_control_state()},deliver_next_page:function(e){e.preventDefault();var next_page_number=this.vars.current_page_number+1,$next_page=$("#page"+next_page_number);if(this.vars.current_page_number<this.vars.page_count){this.retrieve_image($next_page.attr("data-doi"),$next_page.attr("data-s3"),next_page_number,$next_page.attr("data-pagename"),$next_page.attr("data-page"));this.scroll_to_top()}this.apply_page_control_state()},retrieve_image:function(doi,s3Path,pageNumber,pageName,page){var call_url="/stable/get_image/"+doi+"?path="+s3Path;this.vars.pageName=pageName;this.vars.current_page_number=pageNumber;this.vars.current_page_name=page;if(doi!==undefined&&s3Path!==undefined){this.vars.$scan_image_wrapper.addClass("loading");return $.get(call_url,this.update_image.bind(this)).fail(function(){var errorMessage="call failed getting pagescan image",errorThrown="failure";if(window.wasUnloaded){errorMessage="call failed, user left page before complete";errorThrown="user canceled"}jslogger.log_event("error","page_scan.retrieve_image."+errorThrown,{requested_url:call_url,javascript:errorMessage});var detached_html=$(".no_img_available").detach();this.vars.$scan_image_wrapper.html(detached_html.html());this.vars.$scan_image_wrapper.removeClass("loading")}.bind(this))}else{return this.update_image(undefined)}return},page_current_value:function(){return this.vars.current_page_name!=="nil"?this.vars.current_page_name:"[unnumbered]"},build_new_url:function(url,hash,page_number){if(!url||!page_number){return false}var new_url=replace_url_param(url,"seq",page_number);if(hash){new_url=new_url.replace(hash,"")}new_url+="#page_scan_tab_contents";return new_url},updateURL:function(url){this.new_url=url;try{history.replaceState({},"",this.new_url)}catch(err){return window.location.replace(this.new_url)}},show_nav_bars:function(){return $(".next-page, .previous-page").css("visibility","visible")},update_alt:function(){return"Page "+this.page_current_value()+" of "+this.vars.page_scan_alt},update_image:function(data){if(data===undefined){this.show_page_not_available()}else{this.vars.$image_container.attr("src",data).attr("alt",this.update_alt()).attr("data-page",this.vars.current_page_number).load(function(){this.vars.$scan_image_wrapper.removeClass("loading");this.show_nav_bars()}.bind(this)).each(function(){if(this.complete){$(this).load()}});this.vars.$page_range.html(this.vars.pageName);this.updateURL(this.build_new_url(window.location.href,window.location.hash,this.vars.current_page_number));search_term_highlighting.init($("#page"+this.vars.current_page_number))}},scroll_to_top_offset_value:function(){return this.vars.$element_to_scroll_to_when_navigating.length?this.vars.$element_to_scroll_to_when_navigating.offset().top:0},scroll_to_top:function(){return $("html, body").animate({scrollTop:this.scroll_to_top_offset_value()},100)},apply_page_control_state:function(){if(this.vars.page_count===1){return $(".next-page > a, .previous-page > a").addClass("disabled")}if(this.vars.current_page_number<=1){$(".previous-page > a").addClass("disabled");return $(".next-page > a").removeClass("disabled")}if(this.vars.current_page_number>=this.vars.page_count){$(".previous-page > a").removeClass("disabled");return $(".next-page > a").addClass("disabled")}return $(".next-page > a, .previous-page > a").removeClass("disabled")},get_page_number:function(url,param){var page_number=parseInt(get_query_param(url,param),10);if(!page_number||page_number<1){return 1}if(page_number>this.vars.page_count){return this.vars.page_count}return page_number},set_element_to_scroll_to:function(selector){this.vars.$element_to_scroll_to_when_navigating=$(selector)},show_page_not_available:function(){this.vars.$scan_image_wrapper.html("<div class='no-page-display lookslikeh1 bold txtC'>Page not available</div>");this.vars.$scan_image_wrapper.removeClass("loading");jslogger.log_event("warning","page_scan.show_page_not_available",{javascript:"No pagescan image to show, falling back to 'Page not available'"})}};module.exports=pagescan}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"shared/views/components/get-query-param":14,"shared/views/components/replace-url-param":17,"shared/views/components/term-highlighting":22}],16:[function(require,module,exports){module.exports={pds_config:{$mobile_DOM:undefined},init:function(mobile_id){var $statement=$(".provider-statement");this.pds_config.$mobile_DOM=$statement.wrap("<div>").parent().clone();$statement.unwrap("<div>");if(this.pds_config.$mobile_DOM.find("img").length){var name=this.pds_config.$mobile_DOM.find("img").attr("alt");this.pds_config.$mobile_DOM.find(".smTxt").append('<span class="institute"> '+name+"</span>");this.pds_config.$mobile_DOM.find("img").hide()}$(mobile_id).prepend('<div class="hide-for-large-up">'+this.pds_config.$mobile_DOM.html()+"</div>")}}},{}],17:[function(require,module,exports){var string_length=require("shared/views/components/string-length");module.exports=function(href,parameter_name,new_parameter_value){if(!href||!parameter_name){return}if(!new_parameter_value){new_parameter_value=""}if(!string_length(href,parameter_name)){return href+(string_length(href,"\\?")?"&":"?")+parameter_name+"="+new_parameter_value}var pattern=new RegExp("("+parameter_name+"=)[a-zA-Z0-9%+_ ]+");return href.replace(pattern,parameter_name+"="+new_parameter_value)}},{"shared/views/components/string-length":20}],18:[function(require,module,exports){module.exports={init:function($ad_obj){if(!($ad_obj instanceof jQuery)){return false}if($("html.touch").length){this.move_for_touch($ad_obj)}},move_for_touch:function($ad_obj){$ad_obj.css({position:"relative",right:"inherit",top:"inherit"}).addClass("mvl");$("#article_view_content .copyright-statement").before($ad_obj)}}},{}],19:[function(require,module,exports){var mobile_helper=require("shared/controllers/mobile-helper");module.exports={shelfInfo:{currentPanel:undefined,isOpen:false,$banners:$(".banner a.shelf[data-banner-id]"),defaultParentClass:$(".banner a.shelf[data-banner-id]").parent("div").attr("class"),$parent:$(".banner a.shelf[data-banner-id]").parent("div")},init:function(){var $banner,$close_button=$(".banner a.close-banner"),$image_container=$("img.page-scan-container"),timer=0;this.shelfInfo.$banners.click({self:this},function(event){event.preventDefault();$banner=$("#"+$(this).data("banner-id"));if($banner.length){event.data.self.toggle($banner)}});$close_button.click({self:this},function(event){event.preventDefault();event.data.self.slideUp()});$(window).resize({self:this},function(event){clearTimeout(timer);timer=setTimeout(event.data.self.adjustButtonPosition.bind(event.data.self),300)});$image_container.load(this.adjustButtonPosition.bind(this))},toggle:function(requestedPanel){if(requestedPanel!=null){if(this.shelfInfo.currentPanel===undefined){this.shelfInfo.currentPanel=requestedPanel;this.slideDown()}else if(this.shelfInfo.currentPanel.selector!==requestedPanel.selector){this.slideUp();this.shelfInfo.currentPanel=requestedPanel;this.slideDown()}else if(this.shelfInfo.currentPanel.selector===requestedPanel.selector){this.toggleUpOrDown()}}},slideUp:function(){this.shelfInfo.isOpen=false;this.shelfInfo.currentPanel.hide()},slideDown:function(){this.shelfInfo.isOpen=true;this.shelfInfo.currentPanel.show()},toggleUpOrDown:function(){if(this.shelfInfo.isOpen){this.slideUp()}else{this.slideDown()}},adjustButtonPosition:function(){var page_scan_content_width=$("#page_scan_tab_contents .page-scan-wrapper").width();if(mobile_helper.isWindowSizeSmall()&&page_scan_content_width>window.innerWidth){this.shelfInfo.$parent.attr("class","small-12 columns");this.shelfInfo.$banners.css({left:15})}else if(!mobile_helper.isWindowSizeSmall()&&page_scan_content_width>window.innerWidth){this.shelfInfo.$parent.attr("class",this.shelfInfo.defaultParentClass);this.shelfInfo.$banners.css({right:page_scan_content_width-(window.innerWidth-30),left:"auto"})}else if(window.innerWidth>page_scan_content_width){this.shelfInfo.$parent.attr("class",this.shelfInfo.defaultParentClass);this.shelfInfo.$banners.css({right:5,left:"auto"})}}}},{"shared/controllers/mobile-helper":2}],20:[function(require,module,exports){module.exports=function(string,match){"use strict";if(!string||string===""||!match||match===""){return 0}return(string.match(new RegExp(match,"g"))||[]).length}},{}],21:[function(require,module,exports){var clean_item=function(item){"use strict";return item.replace(/([\[\]])+/g,"").trim()};module.exports=function(liststring){"use strict";if(typeof liststring!=="string"){return false}var i=0,list=liststring.split(","),len=list.length,item,results=[];for(i;i<len;i++){item=list[i];results.push(clean_item(item))}return results}},{}],22:[function(require,module,exports){var string_to_list=require("shared/views/components/string-to-list");module.exports={settings:{highlighter_class:"highlight highlight-ocr",$highlights_container:$("#search-term-highlight-container")},position_height:function(coords){if(coords&&typeof coords.b==="number"&&typeof coords.t==="number"){return coords.b-coords.t}return 0},position_width:function(coords){if(coords&&typeof coords.r==="number"&&typeof coords.l==="number"){return coords.r-coords.l}return 0},position:function(coords){if(coords&&typeof coords.t==="number"&&typeof coords.l==="number"){return{display:"block",height:this.position_height(coords),width:this.position_width(coords),top:coords.t,left:coords.l}}return{}},inject_highlight:function(index,coords){if(coords&&typeof coords.t==="number"){this.settings.$highlights_container.append('<span id="highlight-'+index+'" class="'+this.settings.highlighter_class+'"></span>');return $("#highlight-"+index).css(this.position(coords))}return false},inject_highlights:function(response){if(response&&response.ocr_coordinates&&response.ocr_coordinates.length){var i=0;for(i;i<response.ocr_coordinates.length;i++){this.inject_highlight(i,response.ocr_coordinates[i])}return true}return false},init:function($page){$(".highlight.highlight-ocr").remove();if(!$page||!$page.length||!$page.is(":visible")||!this.settings.$highlights_container.length||!this.settings.$highlights_container.data("search-text").length){return false}$.ajax({url:"/ocr/",type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify({s3url:$page.data("ocr"),searchTerms:string_to_list(this.settings.$highlights_container.data("search-text"))}),success:this.inject_highlights.bind(this)});return true}}},{"shared/views/components/string-to-list":21}],23:[function(require,module,exports){(function(global){var copyToClipboard=require("shared/views/components/copy-to-clipboard"),Handlebars=require("handlebars");typeof window!=="undefined"?window["jslogger"]:typeof global!=="undefined"?global["jslogger"]:null;module.exports={ajax_calls:0,cite_this_class:".cite-this-item",citation_mla_class:".copy-citation-mla",citation_mla_endpoint:"/citation/mla/",citation_apa_class:".copy-citation-apa",citation_apa_endpoint:"/citation/apa/",citation_chicago_class:".copy-citation-chicago",citation_chicago_endpoint:"/citation/chicago/",export_citation_ris_anchor:".export-citation-ris a",export_citation_ris_endpoint:"/citation/ris/",export_citation_text_anchor:".export-citation-text a",export_citation_text_endpoint:"/citation/text/",export_citation_refworks_anchor:".export-citation-refworks a",export_citation_refworks_endpoint:"/citation/refworks/",ris_bulk_export:".ris_bulk_export",bibtex_bulk_export:".bibtex_bulk_export",refworks_bulk_export:".refworks_bulk_export",update_endpoints_for_local_development:function(){var host="http://firefly.jstor.org";this.citation_mla_endpoint=host+this.citation_mla_endpoint;this.citation_apa_endpoint=host+this.citation_apa_endpoint;this.citation_chicago_endpoint=host+this.citation_chicago_endpoint},get_mla:function(doi){this.ajax_calls++;this.get_citation(this.citation_mla_endpoint+doi,doi,"MLA","mla",this.citation_mla_class)},get_apa:function(doi){this.ajax_calls++;this.get_citation(this.citation_apa_endpoint+doi,doi,"APA","apa",this.citation_apa_class)},get_chicago:function(doi){this.ajax_calls++;this.get_citation(this.citation_chicago_endpoint+doi,doi,"CHICAGO","chicago",this.citation_chicago_class)},get_citation:function(endpoint,doi,label,class_name,class_to_update){var template=Handlebars.compile($("#tpl-citation_item").html(),{noEscape:true}),template_params={},self=this,start_timer;$.ajax({url:endpoint+"?callback=get_citation_json",cache:false,dataType:"jsonp",contentType:"application/json",beforeSend:function(){start_timer=(new Date).getTime()},success:function(response,status,xhr){response=JSON.parse(response);if(response.success==="true"){template_params={label:label,class_name:class_name,citation:response.citation};$(class_to_update).html(template(template_params));copyToClipboard.activate(class_to_update+" button")}else{jslogger.log_event("error","citation-tools.get_citation.service_error",{requested_url:endpoint,javascript:"Service didn't respond with a success while retrieving citation style "+label+" for "+doi+" | "+response.error_message});$(class_to_update).html("There was a problem retrieving "+label+" citation.")}},error:function(jqXHR,textStatus,errorThrown){var errorMessage="call failed retrieving citation style "+label+" for "+doi+" [ "+jqXHR.status+" / "+textStatus+" / "+errorThrown+" ]";if(window.wasUnloaded){errorMessage="call failed, user left page before complete";errorThrown="user canceled"}jslogger.log_event("error","citation-tools.get_citation."+String(errorThrown).toLowerCase(),{requested_url:endpoint,javascript:errorMessage});$(class_to_update).html("There was a problem retrieving "+label+" citation.")},complete:function(jqXHR,textStatus){var call_time=(new Date).getTime()-start_timer;self.ajax_calls--;if(self.is_ajax_complete()){$("#citation-tools").attr("aria-busy","false")}$(window).trigger("call_complete",[{js_location:"citation-tools.get_citation",requested_url:endpoint,response:textStatus,http_code:jqXHR.status,time:call_time}])},timeout:1e4})},post_bulk_citation_export:function(citation_type,form_id){var $checkboxform=$(form_id+" input:checkbox:checked");if(this.checkboxformlist){$checkboxform=$(this.checkboxformlist+" input:checkbox:checked").clone().attr("name","citations").addClass("hide");$checkboxform.appendTo(form_id)}if(!$checkboxform.length){return false}$(form_id).attr("action",this.original_action+"/"+citation_type);if(citation_type==="refworks"){$(form_id).attr("target","_blank")}$(form_id).submit();return false},update_bulk_links:function(number_of_selected_items){if(number_of_selected_items===0){$("#export-bulk-drop a").addClass("disabled")}else{$("#export-bulk-drop a").removeClass("disabled")}},is_ajax_complete:function(){return this.ajax_calls===0},init:function(citationBulkExportForm,checkboxform){var self=this,is_debug=$("#env_info").data("debug");if(is_debug==="True"){this.update_endpoints_for_local_development()}$(this.cite_this_class).click(function(){var doi=$(this).data("doi");self.$return_element=$(this);self.get_mla(doi);self.get_apa(doi);self.get_chicago(doi);$(self.export_citation_ris_anchor).attr("href",self.export_citation_ris_endpoint+doi);$(self.export_citation_text_anchor).attr("href",self.export_citation_text_endpoint+doi);$(self.export_citation_refworks_anchor).attr("href",self.export_citation_refworks_endpoint+doi)});if($(citationBulkExportForm).length){this.update_bulk_links(0);$("input:checkbox").on("change",function(){self.update_bulk_links($("input:checked").length)})}this.original_action=$(citationBulkExportForm).attr("action");this.checkboxformlist=checkboxform||false;$(this.ris_bulk_export).click(function(){self.post_bulk_citation_export("ris",citationBulkExportForm);return false});$(this.bibtex_bulk_export).click(function(){self.post_bulk_citation_export("text",citationBulkExportForm);return false});$(this.refworks_bulk_export).click(function(){self.post_bulk_citation_export("refworks",citationBulkExportForm);return false});$("#citation-tools").on("opened.fndtn.reveal",function(){$(this).attr("tabindex",-1);$(this).attr({"aria-hidden":"false","aria-busy":"true"});$("div.reveal-modal-bg").attr("aria-hidden","true");$(this).focus()});$("#citation-tools").on("closed.fndtn.reveal",function(){$(this).find(self.citation_mla_class).html("Loading...");$(this).find(self.citation_apa_class).html("Loading...");$(this).find(self.citation_chicago_class).html("Loading...");$(this).attr({"aria-hidden":"true","aria-busy":"false"});$("div.reveal-modal-bg").attr("aria-hidden","false");copyToClipboard.deactivate();self.$return_element.focus()})}}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{handlebars:9,"shared/views/components/copy-to-clipboard":13}]},{},[1]);