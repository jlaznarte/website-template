var Doorbell=function(){var options={},host=null,submitting=false,uploading=false,uploadedAttachments=[],isPostmessageIframeLoaded=false,properties={},screenshot='',generatingScreenshot=false,generatingScreenshotTime=0,submitAfterScreenshot=false,defaultStrings={'title':'Feedback','intro-text':'','feedback-textarea-placeholder':'Send us your comments or suggestions...','feedback-label':'','attach-a-screenshot':'Attach a screenshot of you what you\u0027re seeing','email-input-placeholder':'Your email address','email-label':'Your email, if you want us to reach you back','submit-button-text':'Send','feedback-button-text':'Feedback','add-attachments-label':'Add an attachment','message-success':null,'message-error-missing-email':null,'message-error-invalid-email':null,'message-error-missing-message':null,'message-error-message-too-short':null},option=function(o){if(typeof options[o]!=='undefined'){return options[o];}else{return null;}},canUploadAttachments=function(){if(!supportAjaxUploadWithProgress()){return false;}
return false;},installed=function(){return!!1;},getString=function(s){var strings=option('strings');if(strings!==null&&typeof strings==='object'&&typeof strings[s]!=='undefined'){return strings[s];}
if(typeof defaultStrings[s]!=='undefined'){return defaultStrings[s];}
return null;},getAppId=function(){return'1904';},getAppKey=function(){return options.appKey;},disableButton=function(text){var button=el('doorbell-submit-button');if(!button.disabled){button.className+=' disabled';button.disabled=true;var currentText=button.innerHTML;button.setAttribute('data-original-text',currentText);}
if(typeof text!=='undefined'&&text.length>0){button.innerHTML=text;}},enableButton=function(){var button=el('doorbell-submit-button');button.className=button.className.replace('disabled','');button.disabled=false;button.innerHTML=button.getAttribute('data-original-text');},supportAjaxUploadWithProgress=function(){function supportFileAPI(){var fi=document.createElement('INPUT');fi.type='file';return'files'in fi;}
function supportAjaxUploadProgressEvents(){var xhr=new XMLHttpRequest();return!!(xhr&&('upload'in xhr)&&('onprogress'in xhr.upload));}
function supportFormData(){return!!window.FormData;}
try{return supportFileAPI()&&supportAjaxUploadProgressEvents()&&supportFormData();}catch(e){return false;}},canSendScreenshot=function(){return(isPostmessageIframeLoaded||supportAjaxUploadWithProgress())&&typeof html2canvas==='function'&&false;},showForm=function(){var onShowCallback=option('onShow');if(typeof onShowCallback==='function'){if(onShowCallback()===false){return;}}
openForm();var shouldGenerateScreenshot=true;var onGenerateScreenshotCallback=option('onGenerateScreenshot');if(typeof onGenerateScreenshotCallback==='function'){if(onGenerateScreenshotCallback()===false){shouldGenerateScreenshot=false;}}
if(canSendScreenshot()===true&&shouldGenerateScreenshot===true){try{var proxy=host+'/html2canvasproxy.php';generatingScreenshot=true;generatingScreenshotTime=0;var screenshotStart=new Date().getTime();html2canvas([document.body],{proxy:proxy,async:true,logging:!!'',onrendered:function(canvas){generatingScreenshotTime=(new Date().getTime())-screenshotStart;screenshot=canvas.toDataURL();var onScreenshotGeneratedCallback=option('onScreenshotGenerated');if(typeof onScreenshotGeneratedCallback==='function'){onScreenshotGeneratedCallback(screenshot);}
generatingScreenshot=false;if(submitAfterScreenshot){submit();}}});}catch(e){var attachScreenshotCheckboxWrapper=el('doorbell-attach-screenshot-wrapper');if(attachScreenshotCheckboxWrapper){attachScreenshotCheckboxWrapper.style.display='none';}}}},getScroll=function(){if(window.pageYOffset!=undefined){return[pageXOffset,pageYOffset];}else{var sx,sy,d=document,r=d.documentElement,b=d.body;sx=r.scrollLeft||b.scrollLeft||0;sy=r.scrollTop||b.scrollTop||0;return[sx,sy];}},getYScroll=function(){return getScroll()[1];},isInline=function(){return option('container')!==null;},isModal=function(){return!isInline();},openForm=function(){window.scroll(0,0);var emailField=el('doorbell-email');var emailLabel=el('doorbell-email-label');if(option('hideEmail')){emailField.style.display='none';if(emailLabel){emailLabel.style.display='none';}}else{emailField.style.display='block';if(emailLabel){emailLabel.style.display='block';}}
if(option('email')!==null){emailField.value=option('email');}
el('doorbell').style.display='block';if(isModal()){el('doorbell-background').style.display='block';el('doorbell').style.top=getYScroll()+100+'px';el('doorbell-feedback').focus();}
formOpened();var onShownCallback=option('onShown');if(typeof onShownCallback==='function'){onShownCallback();}},el=function(id){return document.getElementById(id);},hideForm=function(){if(el('doorbell').style.display==='none'){return;}
var onHideCallback=option('onHide');if(typeof onHideCallback==='function'){if(onHideCallback()===false){return;}}
var successContainer=getAlertBox('success');successContainer.style.display='none';var errorContainer=getAlertBox('error');errorContainer.style.display='none';el('doorbell-background').style.display='none';el('doorbell').style.display='none';screenshot='';var onHiddenCallback=option('onHidden');if(typeof onHiddenCallback==='function'){onHiddenCallback();}},getSuccessMessage=function(defaultMessage){var successMessage=option('successMessage');if(successMessage){return successMessage;}
successMessage=getString('message-success');if(successMessage){return successMessage;}
return defaultMessage;},getErrorCode=function(error){if(typeof error==='string'){return null;}
if(typeof error==='object'){return error.type;}
return null;},getErrorMessage=function(error){if(typeof error==='string'){return error;}
if(typeof error==='object'){var errorType=error.type;var errorMessage=getString('message-error-'+errorType);if(errorMessage){return errorMessage;}}
return error.message;},showSuccessMessage=function(message){var successElement=getAlertBox('success');successElement.innerHTML=getSuccessMessage(message);successElement.style.display='block';setTimeout(function(){hideForm();},2000);},getEmail=function(){return el('doorbell-email').value;},getValuesOfExtraFormFields=function(input,textarea,select){var extraFields={};var formFields,formFieldCounter,field;var ignoreFields=['doorbell-feedback','doorbell-email'];formFields=input;for(formFieldCounter=0;formFieldCounter<formFields.length;formFieldCounter++){field=formFields[formFieldCounter];if(ignoreFields.indexOf(field.id)<0&&field.value.length>0&&field.name.length>0){if(field.type=='radio'||field.type=='checkbox'){if(field.checked){extraFields[field.name]=field.value;}}else{extraFields[field.name]=field.value;}}}
formFields=textarea;for(formFieldCounter=0;formFieldCounter<formFields.length;formFieldCounter++){field=formFields[formFieldCounter];if(ignoreFields.indexOf(field.id)<0&&field.value.length>0&&field.name.length>0){extraFields[field.name]=field.value;}}
var selectValue;formFields=select;for(formFieldCounter=0;formFieldCounter<formFields.length;formFieldCounter++){field=formFields[formFieldCounter];selectValue=field.options[field.selectedIndex].value;if(ignoreFields.indexOf(field.id)<0&&selectValue.length>0&&field.name.length>0){extraFields[field.name]=selectValue;}}
return extraFields;},isEmpty=function(obj){for(var prop in obj){if(obj.hasOwnProperty(prop))
return false;}
return true;},formHasFiles=function(form){if(!form){return false;}
var inputs=form.getElementsByTagName('input');for(var i=0;i<inputs.length;i++){var input=inputs[i];if(input.type==='file'){if(input.files&&input.files.length>0){return true;}}}
return false;},clearFileInput=function(oldInput){try{var newInput=document.createElement("input");newInput.type="file";newInput.id=oldInput.id;newInput.name=oldInput.name;newInput.multiple=oldInput.multiple;newInput.onchange=oldInput.onchange;oldInput.parentNode.replaceChild(newInput,oldInput);}catch(e){}},clearFileInputsInForm=function(form){if(!form){return false;}
var inputs=form.getElementsByTagName('input');for(var i=0;i<inputs.length;i++){var input=inputs[i];if(input.type==='file'){if(input.files&&input.files.length>0){clearFileInput(input);}}}
return false;},submit=function(customMessage,customEmail,successCallback,errorCallback){if(submitting||uploading){return false;}
var errorContainer=getAlertBox('error');errorContainer.style.display='none';var uploadForm=el('doorbell-form');if(uploadedAttachments.length===0&&uploadForm&&formHasFiles(uploadForm)){uploading=true;disableButton();uploadFile(uploadForm,function(attachments){uploading=false;uploadedAttachments=attachments;submit(customMessage,customEmail,successCallback,errorCallback);},function(text){uploading=false;errorContainer.style.display='block';errorContainer.innerHTML=text;enableButton();});return false;}
var wantToSendScreenshot=false;if(el('doorbell-attach-screenshot')&&el('doorbell-attach-screenshot').checked){wantToSendScreenshot=true;}
disableButton();if(wantToSendScreenshot&&generatingScreenshot){submitAfterScreenshot=true;return;}
submitAfterScreenshot=false;submitting=true;try{var screenResolution=screen.width+'x'+screen.height;addProperty('Screen resolution',screenResolution);}catch(e){}
try{var w=window,d=document,e=d.documentElement,g=d.getElementsByTagName('body')[0],x=w.innerWidth||e.clientWidth||g.clientWidth,y=w.innerHeight||e.clientHeight||g.clientHeight;var browserSize=x+'x'+y;addProperty('Browser size',browserSize);}catch(e){}
var feedback=el('doorbell-feedback').value;var email=getEmail();if(typeof customMessage!=='undefined'){feedback=customMessage;}
if(typeof customEmail!=='undefined'){email=customEmail;}
try{var form=el('doorbell-form');var extraFields;if(form){extraFields=getValuesOfExtraFormFields(form.getElementsByTagName('input'),form.getElementsByTagName('textarea'),form.getElementsByTagName('select'));if(!isEmpty(extraFields)){addProperty('Fields',extraFields);}}}catch(e){log('Failed to get extra properties from fields');}
var serializedProperties;try{serializedProperties=JSON.stringify(properties);}catch(e){log('Failed to serialize the properties');serializedProperties=properties;}
var data='message='+encodeURIComponent(feedback)+'&email='+encodeURIComponent(email)+'&properties='+encodeURIComponent(serializedProperties);var name=option('name');if(name!==null){data+='&name='+encodeURIComponent(name);}
var tags=option('tags');if(tags!==null){if(Object.prototype.toString.call(tags)==='[object Array]'){tags=tags.join(',');}
if(typeof tags==='string'){data+='&tags='+encodeURIComponent(tags);}}
if(uploadedAttachments.length>0){for(var i=0;i<uploadedAttachments.length;i++){data+='&attachments[]='+encodeURIComponent(uploadedAttachments[i]);}}
try{data+='&url='+encodeURIComponent(window.location.href);}catch(e){data+='&no_url=1';}
data+='&error_detail=1';if(generatingScreenshotTime){data+='&screenshot_generation_time='+generatingScreenshotTime;}
ajax({url:host+'/api/applications/'+getAppId()+'/submit',data:data,success:function(data){el('doorbell-feedback').value='';clearFileInputsInForm(form);uploadedAttachments=[];var onSuccessCallback=option('onSuccess');if(typeof onSuccessCallback==='function'){onSuccessCallback();}
if(typeof successCallback==='function'){successCallback();}
showSuccessMessage(data);},error:function(error){var errorMessage=getErrorMessage(error);errorContainer.innerHTML=errorMessage;errorContainer.style.display='block';var errorCode=getErrorCode(error);if(errorCode==='invalid-email'||errorCode==='missing-email'){var emailField=el('doorbell-email');if(emailField){emailField.style.display='block';}}
if(typeof errorCallback==='function'){errorCallback(errorMessage);}},complete:function(){submitting=false;enableButton();}});},isElementVisible=function(el){if(!el.getClientRects){return fallbackIsElementVisible(el);}
try{return!!(el.offsetWidth||el.offsetHeight||el.getClientRects().length);}catch(e){return fallbackIsElementVisible(el);}},fallbackIsElementVisible=function(el){var style=window.getComputedStyle(el);return!(style.display==='none')},formOpened=function(){var poweredByLink=el('doorbell-powered-by');var visible='0';if(poweredByLink&&isElementVisible(poweredByLink)){visible='1';}
ajax({url:host+'/api/applications/'+getAppId()+'/open',data:'powered-by-link-visible='+visible,success:function(data){},error:function(error){}});},ping=function(){if(installed()){return;}
ajax({url:host+'/api/applications/'+getAppId()+'/ping',success:function(data){},error:function(error){}});},log=function(message){if(typeof console!=='undefined'&&typeof console.log!=='undefined'){console.log(message);}},addProperty=function(name,value){properties[name]=value;},getAuthParams=function(){var params='key='+getAppKey()+'&library=javascript';var timestamp=option('timestamp');if(timestamp){params+='&timestamp='+timestamp;}
var token=option('token');if(token){params+='&token='+token;}
var signature=option('signature');if(signature){params+='&signature='+signature;}
return params;},ajax=function(params){if(typeof params.data==='undefined'){params.data='';}
if(params.data.length>0){params.data+='&';}
params.data+=getAuthParams();var sendScreenshot=false;if(el('doorbell-attach-screenshot')&&el('doorbell-attach-screenshot').checked&&screenshot.length>0){sendScreenshot=true;}
if(supportAjaxUploadWithProgress()){if(sendScreenshot){params.data+='&screenshot='+screenshot;}
makeCorsCall(params);}else if(isPostmessageIframeLoaded){if(sendScreenshot){params.data+='&screenshot='+screenshot;}
params.referrer=window.location.href;makePostmessageCall(params);}else{makeJsonpCall(params);}},ajaxCallback=function(data,code,params){if(code>=200&&code<300){if(typeof params.success!=='undefined'){params.success(data);}}else{if(typeof params.error!=='undefined'){params.error(data);}}
if(typeof params.complete!=='undefined'){params.complete(data);}
if(typeof params.callback!=='undefined'){var callback=params.callback;var scriptTag=el('doorbell-'+callback);if(scriptTag){removeElement('doorbell-'+callback);try{delete window[callback];}catch(e){window[callback]=undefined;}}}},makeCorsCall=function(params){var xhr=new XMLHttpRequest();function onReadyStateChangeHandler(evt){var status,text,readyState;try{readyState=evt.target.readyState;text=evt.target.responseText;status=evt.target.status;}catch(e){ajaxCallback(e,500,params);return;}
if(readyState==4){if(status>=200&&status<300&&evt.target.responseText){ajaxCallback(text,status,params);}else{ajaxCallback(JSON.parse(text),status,params);}}}
xhr.addEventListener('readystatechange',onReadyStateChangeHandler,false);xhr.open('POST',params.url,true);xhr.send(params.data);},makePostmessageCall=function(params){var callback='jsonp'+(new Date().getTime());params.callback=callback;window[callback]=function(response){ajaxCallback(response.data,response.code,params);};if(typeof doorbellpm!=='undefined'){doorbellpm({target:window.frames["doorbellIframe"],type:"doorbellSend",data:params});}},makeJsonpCall=function(params){var callback='jsonp'+(new Date().getTime());params.callback=callback;params.data+='&callback='+params.callback;window[callback]=function(response){ajaxCallback(response.data,response.code,params);};var head=document.getElementsByTagName('head')[0];var script=document.createElement('script');script.id='doorbell-'+callback;script.src=params.url+'?'+params.data;script.onerror=function(){removeElement('doorbell-'+callback);log('Error loading JSONP script: '+script.src);};head.appendChild(script);},uploadFile=function(form,successCallback,errorCallback){function onReadyStateChangeHandler(evt){var status,text,readyState;try{readyState=evt.target.readyState;text=evt.target.responseText;status=evt.target.status;}catch(e){errorCallback(e);return;}
if(readyState==4){if(status>=200&&status<300&&evt.target.responseText){successCallback(JSON.parse(evt.target.responseText));}else{if((status==0||status==413)&&!text){text='Attachment too big';}
errorCallback(text);}}}
var formData=new FormData(form);var xhr=new XMLHttpRequest();xhr.addEventListener('readystatechange',onReadyStateChangeHandler,false);xhr.open('POST',host+'/api/applications/'+getAppId()+'/upload?'+getAuthParams(),true);xhr.send(formData);},getAlertBox=function(type){var alert=el('doorbell-'+type);if(alert){return alert;}
alert=document.createElement('div');if(type==='success'){alert.id='doorbell-success';alert.className='alert alert-success';}else if(type==='error'){alert.id='doorbell-error';alert.className='alert alert-error alert-danger';}else{return;}
var doorbellContainer=el('doorbell-container');var fieldset=doorbellContainer.getElementsByTagName('fieldset')[0];var legend=doorbellContainer.getElementsByTagName('legend')[0];fieldset.insertBefore(alert,legend);return alert;},removeElement=function(id){var removeEl=el(id);if(removeEl){try{removeEl.parentNode.removeChild(removeEl);}catch(e){}}};if(typeof JSON!=='object'){JSON={};}
(function(){'use strict';function f(n){return n<10?'0'+n:n;}
if(typeof Date.prototype.toJSON!=='function'){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+'-'+
f(this.getUTCMonth()+1)+'-'+
f(this.getUTCDate())+'T'+
f(this.getUTCHours())+':'+
f(this.getUTCMinutes())+':'+
f(this.getUTCSeconds())+'Z':null;};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf();};}
var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={'\b':'\\b','\t':'\\t','\n':'\\n','\f':'\\f','\r':'\\r','"':'\\"','\\':'\\\\'},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==='string'?c:'\\u'+('0000'+a.charCodeAt(0).toString(16)).slice(-4);})+'"':'"'+string+'"';}
function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==='object'&&typeof value.toJSON==='function'){value=value.toJSON(key);}
if(typeof rep==='function'){value=rep.call(holder,key,value);}
switch(typeof value){case'string':return quote(value);case'number':return isFinite(value)?String(value):'null';case'boolean':case'null':return String(value);case'object':if(!value){return'null';}
gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==='[object Array]'){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||'null';}
v=partial.length===0?'[]':gap?'[\n'+gap+partial.join(',\n'+gap)+'\n'+mind+']':'['+partial.join(',')+']';gap=mind;return v;}
if(rep&&typeof rep==='object'){length=rep.length;for(i=0;i<length;i+=1){if(typeof rep[i]==='string'){k=rep[i];v=str(k,value);if(v){partial.push(quote(k)+(gap?': ':':')+v);}}}}else{for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?': ':':')+v);}}}}
v=partial.length===0?'{}':gap?'{\n'+gap+partial.join(',\n'+gap)+'\n'+mind+'}':'{'+partial.join(',')+'}';gap=mind;return v;}}
if(typeof JSON.stringify!=='function'){JSON.stringify=function(value,replacer,space){var i;gap='';indent='';if(typeof space==='number'){for(i=0;i<space;i+=1){indent+=' ';}}else if(typeof space==='string'){indent=space;}
rep=replacer;if(replacer&&typeof replacer!=='function'&&(typeof replacer!=='object'||typeof replacer.length!=='number')){throw new Error('JSON.stringify');}
return str('',{'':value});};}
if(typeof JSON.parse!=='function'){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==='object'){for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v;}else{delete value[k];}}}}
return reviver.call(holder,key,value);}
text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return'\\u'+
('0000'+a.charCodeAt(0).toString(16)).slice(-4);});}
if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,'@').replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,']').replace(/(?:^|:|,)(?:\s*\[)+/g,''))){j=eval('('+text+')');return typeof reviver==='function'?walk({'':j},''):j;}
throw new SyntaxError('JSON.parse');};}}());return{init:function(opts){options=opts;var onLoadCallback=option('onLoad');if(typeof onLoadCallback==='function'){onLoadCallback();}
host='https://doorbell.io';var hideButton=option('hideButton');if((hideButton===null||hideButton===false)&&isModal()){var button=document.createElement('button');button.id='doorbell-button';button.onclick=showForm;button.style.visibility='hidden';button.innerHTML=getString('feedback-button-text');document.body.appendChild(button);}
var stylesheet=document.createElement('link');stylesheet.href='https://embed.doorbell.io/css/doorbell.min.css?v=1452169039';stylesheet.rel='stylesheet';stylesheet.type='text/css';var head=document.getElementsByTagName('head')[0];head.insertBefore(stylesheet,head.firstChild);var initProperties=option('properties');if(typeof initProperties==='object'&&initProperties!==null){properties=initProperties;}
var emailLabel=getString('email-label');if(emailLabel){emailLabel='<label for="doorbell-email" id="doorbell-email-label">'+emailLabel+'</label>';}
var emailField=emailLabel+'<input type="email" id="doorbell-email" class="form-control" placeholder="'+getString('email-input-placeholder')+'" value="" />';if(typeof doorbellpm!=='undefined'){doorbellpm.bind("doorbellIframeloaded",function(){isPostmessageIframeLoaded=true;return true;});doorbellpm.bind("doorbellSuccess",function(data){window[data.callback](data);return true;});doorbellpm.bind("doorbellError",function(data){window[data.callback](data);return true;});}
var feedbackLabel=getString('feedback-label');if(feedbackLabel){feedbackLabel='<label for="doorbell-feedback" id="doorbell-feedback-label">'+feedbackLabel+'</label>';}
var postMessageIframe='';var attachScreenshotCheckbox;if(canSendScreenshot()===true){if(!supportAjaxUploadWithProgress()){postMessageIframe='<iframe name="doorbellIframe" id="doorbellIframe" src="'+host+'/api/form?t=1452514953'+'" style="display: none!important;"></iframe>';}
attachScreenshotCheckbox='<div class="checkbox" id="doorbell-attach-screenshot-wrapper"><label><input type="checkbox" id="doorbell-attach-screenshot" value="1" /> '+getString('attach-a-screenshot')+'</label></div>';}else{attachScreenshotCheckbox='';}
var attachFiles='';if(canUploadAttachments()){var addAttachmentLabel=getString('add-attachments-label');if(addAttachmentLabel){addAttachmentLabel='<label for="doorbell-add-attachments" id="doorbell-add-attachments-label">'+addAttachmentLabel+'</label>';}else{addAttachmentLabel='';}
attachFiles=addAttachmentLabel+'<input id="doorbell-add-attachments" name="files[]" type="file" multiple="multiple" />';}
var formHtml='<div id="doorbell-container"><button id="doorbell-close" title="Close" class="close">&times;</button><form id="doorbell-form" class="dark">        <fieldset>            <legend>'+getString('title')+'</legend>            '+getString('intro-text')+'            '+feedbackLabel+'            <textarea placeholder="'+getString('feedback-textarea-placeholder')+'" class="form-control" id="doorbell-feedback"></textarea>            '+emailField+'            '+attachScreenshotCheckbox+'            '+attachFiles+'            <div class="buttons"><button class="btn btn-primary" id="doorbell-submit-button">'+getString('submit-button-text')+'</button></div>        </fieldset>        <a href="https://doorbell.io" target="_blank" id="doorbell-powered-by" >Powered by Doorbell.io</a>        '+postMessageIframe+'    </form></div>';if(isModal()){var background=document.createElement('div');background.id='doorbell-background';background.className='dark';background.style.display='none';document.body.appendChild(background);background.onclick=function(e){var evt=(e)?e:window.event;if(evt!=null&&evt.target!=null&&evt.target.id=='doorbell-background'){hideForm();}};}
var container=document.createElement('div');container.id='doorbell';container.innerHTML=formHtml;container.style.display='none';if(isModal()){document.body.appendChild(container);el('doorbell-close').onclick=function(){hideForm();};}else{var inlineContainer=option('container');container.className='doorbell-inline';inlineContainer.appendChild(container);}
var doorbellForm=el('doorbell-form');doorbellForm.onsubmit=function(){submit();return false;};var doorbellInputs=doorbellForm.getElementsByTagName('input');for(var i=0;i<doorbellInputs.length;i++){var input=doorbellInputs[i];if(input.type==='file'){input.onchange=function(){uploadedAttachments=[];};}}
el('doorbell-feedback').onkeydown=function(e){var evt=(e)?e:window.event;if((evt.ctrlKey||evt.metaKey)&&evt.keyCode==13){submit();evt.preventDefault();evt.stopPropagation();return false;}};document.onkeydown=function(evt){evt=evt||window.event;if(evt.keyCode==27){hideForm();}};ping();if(isInline()){showForm();}},getProperty:function(name){if(typeof properties[name]!=='undefined'){return properties[name];}else{return null;}},setProperty:function(name,value){addProperty(name,value);},getOption:function(o){return option(o);},setOption:function(option,value){options[option]=value;},setName:function(newName){options.name=newName;},show:function(){showForm();},hide:function(){hideForm();},send:function(message,email,successCallback,errorCallback){submit(message,email,successCallback,errorCallback);},refresh:function(){removeElement('doorbell-button');removeElement('doorbell-background');removeElement('doorbell');this.init(options);}};};if(typeof window.html2canvas==='undefined'){}
(function(){var doorbellOptionsVarName='doorbellOptions';var doorbellOptionsVarNameOverride='';if(doorbellOptionsVarNameOverride.length>0){doorbellOptionsVarName=doorbellOptionsVarNameOverride;}
var doorbellObjectName='doorbell';var doorbellObjectNameOverride='';if(doorbellObjectNameOverride.length>0){doorbellObjectName=doorbellObjectNameOverride;}
var options;if(typeof window[doorbellOptionsVarName]==='undefined'){return;}else if(typeof window[doorbellOptionsVarName].appKey==='undefined'){return;}else{options=window.doorbellOptions;}
window[doorbellObjectName]=new Doorbell();window[doorbellObjectName].init(options);})();